tHd.prototype.zL=r(1309,function(a){this.C.C.GV(a)});BHd.prototype.zL=r(1308,function(a){this.D.zL(a)});cpd.prototype.uka=r(1047,function(){return L(this,3)});zdd.prototype.zm=r(1037,function(){return L(this,1)});pi.prototype.zm=r(1036,function(){return L(this,2)});ah.prototype.Tr=r(54,function(){return G(this,12)});WBd.prototype.Tr=r(53,function(){return L(this,2)});bCd.prototype.Tr=r(52,function(){return L(this,2)});fg.prototype.qs=r(42,function(){return Ke(this,3)});
gg.prototype.qs=r(41,function(){return Ke(this,2)});Jg.prototype.qs=r(40,function(){return Ke(this,1)});ah.prototype.qs=r(39,function(){return Ke(this,1)});Sp.prototype.qs=r(38,function(){return Ke(this,3)});YL.prototype.qs=r(37,function(){return Ke(this,2)});cM.prototype.qs=r(36,function(){return Ke(this,1)});iM.prototype.qs=r(35,function(){return Ke(this,2)});function ADf(a){nR(a,function(b){b=new (b.H())(a.J,a.eb);lR(a,b);b.setVisible(!0)},"ritzmaestro")}
function BDf(a,b){nR(a,function(a){a=a.C(b,this.J,this.Sa);lR(this,a);a.setVisible(!0)},"ritzmaestro")}function CDf(a,b){nR(a,function(a){a=a.D(b,this.J,this.Sa);lR(this,a);a.setVisible(!0)},"ritzmaestro")}function DDf(a,b){var c=Yc;Zc(a,function(a,e){return c(b(a),b(e))})}function EDf(a,b){var c={Tsd:L(b,4)};a&&(c.Ga=b);return c}function FDf(a){K(this,a,0,-1,null,null)}y(FDf,I);FDf.prototype.ma=function(a){return EDf(a,this)};
function GDf(a,b){var c=this;this.H=new yj;this.H.Oi=!0;this.L=new yj;this.J=a;this.F=new ee;this.D=new Map;this.C=new Map;this.Na=new en(this);this.Na.R(b,"external_data_change",function(){HDf(c);c.F.dispatchEvent(null)});HDf(this)}
function IDf(a,b,c){for(var d=ja(Oe(b,1)),e=d.next();!e.done;e=d.next()){e=e.value;var f=e.getFunctionName(),h=a.D.get(f);h?G(e,5)?(a.D.delete(f),a.C.set(f,h)):(f=G(e,3),H(h,8,f),(e=G(e,4))?H(h,9,e):Ne(h,9)):(h=a.C.get(f),e=G(e,3),H(h,8,e),a.D.set(f,h),a.C.delete(f))}a.F.dispatchEvent(null);Hj(dp(Yo(a.J.jf("/editactions"),{data:a.H.serialize(b)}),"POST"),c).$e()}
function HDf(a){var b=JDf(a),c=new Map,d=new Map;b=ja(b);for(var e=b.next();!e.done;e=b.next())e=e.value,Ke(e,8)?c.set(e.getFunctionName(),e):G(e,11)||d.set(e.getFunctionName(),e);a.D=c;a.C=d}function JDf(a){return ritz_api.RitzModelApi.getCustomFunctions().map(function(b){return a.L.ad(ah.Ca(),b)})};function KDf(){return V('<div class="waffle-edit-actions-dialog-scroll"><div class="waffle-edit-actions-dialog-actions-row-container"></div><div class="waffle-edit-actions-empty" role="alert">There are no macros</div></div>')}
function LDf(a){return V('<div class="waffle-edit-actions-row"><div class="waffle-edit-actions-row-name"><input class="waffle-edit-actions-name-input jfk-textinput" maxlength="50"/><div class="waffle-edit-actions-shortcut-conflict-message"></div></div><div class="waffle-edit-actions-options"><div class="waffle-edit-actions-row-shortcut-prefix">'+U(a.Rta)+'</div><div class="waffle-edit-actions-row-shortcut"><input class="waffle-edit-actions-row-shortcut-input jfk-textinput" maxlength="1"/></div><div class="waffle-edit-actions-row-menu"></div></div></div>')}
;function MDf(a,b,c,d){OB.call(this,void 0,!1,d);var e=this;this.V=a;this.O=Array.from(this.V.D.values());DDf(this.O,function(a){return a.getFunctionName()});this.F=b;this.ea=c;this.C=new Map;this.L=null;this.J=new aO("Macro removed","UNDO",function(){return NDf(e)},void 0,this.qa(),"off");this.Aa(this.J);jC(this.ea,this.J);qA(this,sA(new nA,vA,!1,!0).set("save","Update",!0))}v(MDf,OB);
MDf.prototype.Da=function(){OB.prototype.Da.call(this);this.Rr=!1;pA(this,!1);ODf(this,!1);B(A(),"docs-egmd")?(T(kA(this),"waffle-edit-actions-dialog-gm"),xA(this,"save")):T(kA(this),"waffle-edit-actions-dialog");this.setTitle("Manage macros");this.Nb().appendChild(oz(KDf));for(var a=this.Ja("waffle-edit-actions-dialog-actions-row-container"),b=ja(this.O),c=b.next();!c.done;c=b.next()){c=c.value;var d=new PDf(c,this.F);this.Ha(d);this.C.set(c.getFunctionName(),d);d.render(a)}Q(this.Ja("waffle-edit-actions-empty"),
!1);this.J.render();T(this.J.Pa(),"waffle-edit-actions-undo-remove-toast")};function ODf(a,b){rA(a.D,"save").disabled=!b}MDf.prototype.Ia=function(){var a=this;OB.prototype.Ia.call(this);QDf(this);this.getHandler().R(this,"dialogselect",this.oa).R(this.Pa(),"keydown",function(b){13==b.keyCode&&"INPUT"==b.target.tagName&&(b.target.setSelectionRange(0,0),b.target.blur(),b.preventDefault());90==b.keyCode&&b.ctrlKey&&NDf(a)});RDf(this)};
function QDf(a){for(var b={},c=ja(a.C.values()),d=c.next();!d.done;b={oK:b.oK},d=c.next())b.oK=d.value,a.getHandler().R(b.oK.ea,"action",function(b){return function(){return SDf(a,b.oK)}}(b)).R(TDf(b.oK),"input",function(b){return function(){var c=b.oK;UDf(c)?UU(c.ZI):TU(c.ZI,"Must be a number from 0 to 9 or blank.",!0);c=!RDf(a)&&UDf(c);ODf(a,c)}}(b)).R(VDf(b.oK),"input",function(){a.F.C(29573);ODf(a,!0)})}
function RDf(a){var b=new Map;a=ja(a.C.values());for(var c=a.next();!c.done;c=a.next())c=c.value,b.has(WDf(c))?b.get(WDf(c)).push(c):b.set(WDf(c),[c]);a=!1;c=null;b=ja(b);for(var d=b.next();!d.done;d=b.next()){var e=ja(d.value);d=e.next().value;e=e.next().value;1<e.length&&""!=d?(a=!0,c=d,e.forEach(function(a){a=a.Ja("waffle-edit-actions-shortcut-conflict-message");Cv(a,"Conflicts with another shortcut");Q(a,!0)})):e.forEach(function(a){a=a.Ja("waffle-edit-actions-shortcut-conflict-message");Q(a,
!1)})}if(a){var f="Can't save conflicting shortcut "+c;setTimeout(function(){return PK(f)})}return a}function SDf(a,b){ODf(a,!0);a.L=b;a.C.delete(b.Ea);Q(b.Pa(),!1);RDf(a);a.J.setVisible(!0);0==a.C.size&&Q(a.Ja("waffle-edit-actions-empty"),!0);a.Pa().focus();var c="Macro "+(b.C.getValue()+" was removed, Ctrl-Z to Undo");setTimeout(function(){return PK(c)});a.F.C(29572)}
function NDf(a){if(null!=a.L){var b=a.L;a.C.set(b.Ea,b);Q(b.Pa(),!0);Q(a.Ja("waffle-edit-actions-empty"),!1);RDf(a);a.L=null;var c="Macro "+(b.C.getValue()+" is restored.");setTimeout(function(){return PK(c)});a.F.C(29577)}}
MDf.prototype.oa=function(a){var b=this;if("cancel"==a.key)this.F.C(29569);else if("save"==a.key){for(var c=ja(this.C.values()),d=c.next();!d.done;d=c.next())if(d=d.value,!UDf(d)||""!=XDf(d)){a.preventDefault();return}RDf(this)?a.preventDefault():(a=YDf(this),IDf(this.V,a,function(){var a=iC(b.ea,"Failed to update macros.",av(),!0,0,!0,void 0,!0,["waffle-edit-actions-update-failed"]);a.D=!0;a.render();a.setVisible(!0)}),this.F.C(29574),setTimeout(function(){return PK("Macros updated")}))}};
function YDf(a){for(var b=new YQb,c=ja(a.O),d=c.next();!d.done;d=c.next()){var e=d.value;d=new KL;var f=!1,h=a.C.get(e.getFunctionName()),k=G(e,9),l=G(e,8);h?(k!=WDf(h)&&(k=WDf(h),f=!0),l!=h.C.getValue()&&(l=h.C.getValue(),f=!0)):(H(d,5,!0),f=!0);f&&(f=e.lk(),H(d,1,f),e=e.getFunctionName(),H(d,2,e),H(d,3,l),k&&H(d,4,k),Me(b,1,d))}return b}
function PDf(a,b,c){R.call(this,c);this.Ba=a;this.La=G(a,8);this.Ea=a.getFunctionName();this.J=(a=G(a,9))?a.split("+"):[];this.D=new rB;this.Ha(this.D);this.L=this.O=null;this.C=new rB;this.Ha(this.C);this.oa=new ZB;this.Aa(this.oa);this.Ka=b;b=Mx(by,"waffle-overflow-menu-material");this.H=new yy(void 0,void 0,b,this.qa());this.Aa(this.H);this.V=new hy("Edit script");this.Aa(this.V);this.ea=new hy("Remove");this.Aa(this.ea);this.ZI=new SU(this.qa());this.Aa(this.ZI);this.F=new SU(this.qa());this.Aa(this.F)}
v(PDf,R);PDf.prototype.Da=function(){var a=(Kc(this.J)?ZDf:this.J.slice(0,this.J.length-1)).join(" + ")+" + ";a=C.Qn.Aq?a.replace(/Ctrl/g,"\u2318").replace(/Alt/g,"Option"):a;a=oz(LDf,{Rta:a});this.Fb(a)};
PDf.prototype.Ia=function(){var a=this;this.D.Xa(this.Ja("waffle-edit-actions-row-shortcut-input"));this.D.setValue(wc(this.J)||"");B(A(),"docs-egmd")||T(this.Ja("waffle-edit-actions-row-shortcut"),tZ.getInstance().dc());var b=this.Ja("waffle-edit-actions-name-input");this.C.Xa(b);this.C.setValue(this.La);B(A(),"docs-egmd")||T(this.Ja("waffle-edit-actions-row-name"),tZ.getInstance().dc());this.oa.Xa(b);this.ZI.setPosition(3,2);this.ZI.render();b=this.D.Pa();this.ZI.bk(b);VU(this.ZI,b);UU(this.ZI);
this.F.setPosition(0,2);this.F.render();b=this.C.Pa();this.F.bk(b);VU(this.F,b);UU(this.F);b=new uy(this.H.Nb(),13);Fy(this.H,b);this.H.K2=!0;this.H.Vc(this.V);this.H.Vc(this.ea);b=this.Ja("waffle-edit-actions-row-menu");this.H.Xa(b);"black"==Qy()&&T(b,"waffle-overflow-menu-material-white");this.getHandler().R(this.V,"action",function(){(Xu(),iu).Ub({scriptId:a.Ba.lk(),filename:a.Ba.getFileName()});a.Ka.C(29570)}).R(this.C.Pa(),"blur",function(){""==XDf(a)?UU(a.F):TU(a.F,XDf(a),!0)}).R(this.D.Pa(),
"click",function(){return a.D.Pa().select()}).R(TDf(this),"input",function(){return a.Ka.C(29571)});wx(this.Ja("waffle-edit-actions-name-input"),"Macro name");wx(this.D.Pa(),"Numeric shortcut key");wx(b,"More options button")};function WDf(a){var b=a.D.getValue();return""==b?"":(Kc(a.J)?ZDf:a.J.slice(0,a.J.length-1)).join("+")+"+"+b}function TDf(a){null==a.O&&(a.O=new YB(a.D.Pa()),a.Aa(a.O));return a.O}function VDf(a){null==a.L&&(a.L=new YB(a.C.Pa()),a.Aa(a.L));return a.L}
function UDf(a){a=a.D.getValue();return""==a||/^\d$/.test(a)}function XDf(a){a=a.C.getValue();return""==a?"Macro name must be not be empty.":/\r|\n/.test(a)?"Macro name must not contain line-break characters.":""}var ZDf=["Ctrl","Alt","Shift"];function $Df(){return V('<div class="waffle-import-custom-function-actions-title-separator"></div><div class="waffle-import-custom-function-actions-dialog-scroll"><div class="waffle-import-custom-functions-row-container"></div></div>')}
function aEf(a){var b=a.yXb,c=a.fileName;a='<div class="waffle-import-custom-function-row" tabindex="0"><div class="waffle-import-custom-function-name">'+U(a.functionName)+'</div><div class="waffle-import-custom-function-metadata"><div class="waffle-import-custom-function-project-name"><span class="waffle-import-custom-function-description-label">';a=a+"Project:"+('</span><span class="function-description-seperator"></span>'+U(b)+'</div><div class="waffle-import-custom-function-file-name"><span class="waffle-import-custom-function-description-label">');
a=a+"File:"+('</span><span class="function-description-seperator"></span>'+U(c)+'</div></div><div class="waffle-import-custom-function-view-script"></div><div class="waffle-import-custom-function-add-function"></div></div>');return V(a)};function bEf(a,b,c,d){OB.call(this,void 0,!1,d);this.oa=a;this.J=Array.from(this.oa.C.values());DDf(this.J,function(a){return a.getFunctionName()});this.ea=b;this.Ba=c;this.V=[];this.F=[];this.C=iC(this.Ba,"Function added.",av(),!1,3E3,!0,void 0,!0,["waffle-import-custom-function-actions-status-toast"]);this.Aa(this.C);this.La=new cC(this.qa());this.Aa(this.La);this.L=new Co(this.O,3E3,this);this.Aa(this.L)}v(bEf,OB);
bEf.prototype.Da=function(){OB.prototype.Da.call(this);T(kA(this),"waffle-import-custom-function-actions-dialog");this.setTitle("Import");var a=this.qa().Da("DIV","waffle-import-custom-function-title-description","Added functions will appear in the menu under Tools > Macros");iA(this).appendChild(a);this.Nb().appendChild(oz($Df));a=this.Ja("waffle-import-custom-functions-row-container");for(var b=ja(this.J),c=b.next();!c.done;c=b.next())c=new cEf(c.value,this.ea),this.Ha(c),c.render(a),this.V.push(c);
this.C.render();this.C.setVisible(!1);qA(this,null)};bEf.prototype.Ia=function(){var a=this;OB.prototype.Ia.call(this);for(var b={},c=ja(this.V),d=c.next();!d.done;b={z4:b.z4},d=c.next())b.z4=d.value,this.getHandler().R(b.z4.D,"action",function(b){return function(){return dEf(a,b.z4)}}(b));this.getHandler().R(this,"hide",function(){return a.O()})};
function dEf(a,b){eEf(b);var c=fEf(b.C);gEf(a,c);b=b.Ja("waffle-import-custom-function-add-function");b.setAttribute("tabindex","0");wx(b,"This function has been added.");b.focus();a.ea.C(29576);setTimeout(function(){return a.C.setVisible(!0)})}function fEf(a){var b=new KL,c=a.lk();H(b,1,c);c=a.getFunctionName();H(b,2,c);a=a.getFunctionName();H(b,3,a);return b}function gEf(a,b){a.F.push(b);a.L.start()}
bEf.prototype.O=function(){var a=this;if(0<this.F.length){var b=new YQb;this.F.forEach(function(a){Me(b,1,a)});IDf(this.oa,b,function(){var b=iC(a.Ba,"Failed to add function.",av(),!1,1E4,!0,void 0,!0,["waffle-import-custom-function-actions-status-toast"]);b.D=!0;b.render();b.setVisible(!0)});this.F=[]}};
function cEf(a,b,c){R.call(this,c);this.C=a;this.H=b;a=B(A(),"docs-egmd")?fC.getInstance():void 0;this.D=new dy("Add Function",a,c);this.Ha(this.D);this.F=new dy("Edit Script",a,c);this.Ha(this.F)}v(cEf,R);cEf.prototype.Da=function(){R.prototype.Da.call(this);var a=oz(aEf,{functionName:this.C.getFunctionName(),yXb:G(this.C,2),fileName:this.C.getFileName()});this.Fb(a);this.D.render(this.Ja("waffle-import-custom-function-add-function"));this.F.render(this.Ja("waffle-import-custom-function-view-script"))};
cEf.prototype.Ia=function(){var a=this;R.prototype.Ia.call(this);this.getHandler().R(this.F,"action",function(){(Xu(),iu).Ub({scriptId:a.C.lk(),filename:a.C.getFileName()});a.H.C(29575)});var b="Function: "+(this.C.getFunctionName()+(", from project: "+(G(this.C,2)+(", defined in file: "+this.C.getFileName()))));wx(this.Pa(),b)};function eEf(a){Q(a.D.Pa(),!1);T(a.Ja("waffle-import-custom-function-add-function"),"waffle-import-custom-function-actions-checkmark")};function hEf(a,b){D.call(this);this.C=a;this.Bb=b}y(hEf,D);hEf.prototype.getState=g("Bb");hEf.prototype.Ma=function(){hEf.xa.Ma.call(this);delete this.C;delete this.Bb};function iEf(a,b){D.call(this);this.H=a;this.C=b;this.F=new yj}y(iEf,D);iEf.prototype.D=function(){var a=this.H,b=null;if(null!=this.C&&null!=this.C.getSelection()){var c=this.C.getSelection();b=bm(c);b=b[b.length-1];var d=vd(c.Db()),e={};b=(e.gid=d,e.scol=b.yc(),e.ecol=b.bd(),e.srow=b.zc(),e.erow=b.Wc(),e);Td(b,"sel",this.F.serialize(c.C));b=Uk(b)}return new hEf(a,b)};function jEf(a){K(this,a,0,-1,kEf,null)}y(jEf,I);function lEf(a){K(this,a,0,-1,null,null)}y(lEf,I);function z6(a){K(this,a,0,-1,mEf,null)}y(z6,I);function nEf(a){K(this,a,0,-1,null,null)}y(nEf,I);var kEf=[4];n=jEf.prototype;n.ma=function(a){return oEf(a,this)};function oEf(a,b){var c={id:L(b,1),name:L(b,2),description:L(b,3),a4c:jh(th(b,lEf,4),pEf,a)};a&&(c.Ga=b);return c}n.getId=function(){return L(this,1)};n.Ie=function(a){N(this,1,a)};n.getName=function(){return L(this,2)};
n.Ld=function(a){N(this,2,a)};n.Rf=function(){return L(this,3)};n.Gl=function(a){N(this,3,a)};lEf.prototype.ma=function(a){return pEf(a,this)};function pEf(a,b){var c={name:L(b,1),Nca:L(b,2)};a&&(c.Ga=b);return c}lEf.prototype.getName=function(){return L(this,1)};lEf.prototype.Ld=function(a){N(this,1,a)};var mEf=[6];n=z6.prototype;n.ma=function(a){return qEf(a,this)};
function qEf(a,b){var c={lU:L(b,1),caption:L(b,2),aqd:L(b,3),SIb:L(b,4),key:L(b,5),xI:jh(A6(b),qEf,a),enabled:L(b,7),ZG:L(b,9),Rca:L(b,10),Ggd:M(b,11,0),mtd:L(b,12),vG:L(b,13)};a&&(c.Ga=b);return c}n.Lh=function(){return L(this,2)};n.Xm=function(a){N(this,2,a)};n.W9=function(){return null!=L(this,2)};n.getKey=function(){return L(this,5)};function A6(a){return th(a,z6,6)}n.Vc=function(a){xh(this,6,a,z6)};n.Qa=function(a){N(this,7,a)};n.Tr=function(){return L(this,13)};
nEf.prototype.ma=function(a){var b={Uyd:L(this,1),responseText:L(this,2),NIb:M(this,3,!1),scb:L(this,4)};a&&(b.Ga=this);return b};nEf.prototype.Pj=function(){return L(this,2)};function rEf(a,b,c,d,e,f){D.call(this);this.C=a;this.functionName=b;this.ZG=d||null;this.vG=na(f)?f:null}y(rEf,D);function sEf(a){K(this,a,0,-1,null,null)}y(sEf,I);sEf.prototype.ma=function(a){return tEf(a,this)};function tEf(a,b){var c={zga:L(b,1),tMd:L(b,2),uMd:L(b,3),Qfd:L(b,4)};a&&(c.Ga=b);return c};function uEf(a){K(this,a,0,-1,null,null)}y(uEf,I);uEf.prototype.ma=function(a){return vEf(a,this)};function vEf(a,b){var c,d={zga:L(b,1),xAa:L(b,2),version:L(b,3),Ftd:L(b,5),$9c:L(b,6),Ayd:(c=O(b,sEf,7))&&tEf(a,c),IHc:L(b,8),wKc:L(b,9),V0c:L(b,10),mib:L(b,11)};a&&(d.Ga=b);return d};function wEf(a){K(this,a,"amep",-1,null,null)}y(wEf,I);function xEf(a){K(this,a,"paep",-1,null,null)}y(xEf,I);function yEf(a){K(this,a,"sfep",-1,null,null)}y(yEf,I);function zEf(a){K(this,a,"step",-1,null,null)}y(zEf,I);function AEf(a){K(this,a,"spep",-1,BEf,null)}y(AEf,I);function CEf(a){K(this,a,"saep",-1,null,null)}y(CEf,I);function DEf(a){K(this,a,"snep",-1,null,null)}y(DEf,I);function EEf(a){K(this,a,"rfep",-1,null,null)}y(EEf,I);function FEf(a){K(this,a,"stbep",-1,null,null)}y(FEf,I);
function B6(a){K(this,a,"sttep",-1,null,null)}y(B6,I);wEf.prototype.ma=function(a){var b,c={HE:(b=this.fc())&&qEf(a,b)};a&&(c.Ga=this);return c};wEf.xf="amep";wEf.prototype.fc=function(){return O(this,z6,1,1)};wEf.prototype.Ef=function(a){uh(this,1,a)};wEf.prototype.ls=function(){return null!=L(this,1)};xEf.prototype.ma=function(a){var b,c={url:L(this,1),message:L(this,2),h1c:(b=O(this,uEf,3))&&vEf(a,b),Rcb:L(this,4)};a&&(c.Ga=this);return c};xEf.xf="paep";
xEf.prototype.Xg=function(){return L(this,2)};yEf.prototype.ma=function(a){var b={nca:L(this,1),Fq:L(this,2),message:L(this,3)};a&&(b.Ga=this);return b};yEf.xf="sfep";yEf.prototype.Xg=function(){return L(this,3)};zEf.prototype.ma=function(a){var b={nca:L(this,1),W3a:L(this,2)};a&&(b.Ga=this);return b};zEf.xf="step";zEf.prototype.uka=function(){return L(this,2)};var BEf=[4];
AEf.prototype.ma=function(a){var b={SRc:L(this,1),title:L(this,2),JRc:L(this,3),DMc:lh(this,4),LGc:M(this,5,!1),NIb:M(this,6,!1),scb:L(this,7)};a&&(b.Ga=this);return b};AEf.xf="spep";AEf.prototype.getTitle=function(){return L(this,2)};AEf.prototype.setTitle=function(a){N(this,2,a)};CEf.prototype.ma=function(a){var b,c={iVc:L(this,1),title:L(this,2),fHb:L(this,3),width:L(this,4),height:L(this,5),location:M(this,6,0),SIb:L(this,7),Ohd:M(this,8,!1),W_b:(b=O(this,FDf,9))&&EDf(a,b)};a&&(c.Ga=this);return c};
CEf.xf="saep";n=CEf.prototype;n.getTitle=function(){return L(this,2)};n.setTitle=function(a){N(this,2,a)};n.getWidth=function(){return L(this,4)};n.setWidth=function(a){N(this,4,a)};n.getHeight=function(){return L(this,5)};n.setHeight=function(a){N(this,5,a)};n.Vy=function(){return null!=L(this,6)};DEf.prototype.ma=function(a){var b={type:M(this,1,0),text:L(this,2),title:L(this,3),ZHd:L(this,4)};a&&(b.Ga=this);return b};DEf.xf="snep";n=DEf.prototype;n.getType=function(){return M(this,1,0)};
n.setType=function(a){N(this,1,a)};n.hasType=function(){return null!=L(this,1)};n.getText=function(){return L(this,2)};n.Dm=function(){return null!=L(this,2)};n.getTitle=function(){return L(this,3)};n.setTitle=function(a){N(this,3,a)};EEf.prototype.ma=function(a){var b={q0b:L(this,1),functionName:L(this,2),ZG:L(this,4),vG:L(this,5)};a&&(b.Ga=this);return b};EEf.xf="rfep";EEf.prototype.getFunctionName=function(){return L(this,2)};EEf.prototype.Tr=function(){return L(this,5)};
FEf.prototype.ma=function(a){var b={q0b:L(this,1),functionName:L(this,2),caption:L(this,3),ZG:L(this,4),url:L(this,5),vG:L(this,6)};a&&(b.Ga=this);return b};FEf.xf="stbep";n=FEf.prototype;n.getFunctionName=function(){return L(this,2)};n.Lh=function(){return L(this,3)};n.Xm=function(a){N(this,3,a)};n.W9=function(){return null!=L(this,3)};n.Tr=function(){return L(this,6)};B6.prototype.ma=function(a){var b={text:L(this,1),dh:L(this,2)};a&&(b.Ga=this);return b};B6.xf="sttep";
B6.prototype.getText=function(){return L(this,1)};B6.prototype.Dm=function(){return null!=L(this,1)};B6.prototype.Sk=function(){return L(this,2)};B6.prototype.Td=function(a){N(this,2,a)};function C6(a){vm.call(this,a)}y(C6,vm);function GEf(a){vm.call(this,"amep");this.F=new wEf(a)}y(GEf,C6);GEf.prototype.C=g("F");function HEf(a){K(this,a,"iar",-1,null,null)}y(HEf,I);function IEf(a){K(this,a,"llr",-1,JEf,null)}y(IEf,I);function KEf(a){K(this,a,"rar",-1,null,null)}y(KEf,I);function D6(a){K(this,a,"lsir",-1,null,null)}y(D6,I);function LEf(a){K(this,a,"oau",-1,null,null)}y(LEf,I);function MEf(a){K(this,a,"eer",-1,null,null)}y(MEf,I);function NEf(a){K(this,a,"der",-1,null,null)}y(NEf,I);function OEf(a){K(this,a,"uer",-1,null,null)}y(OEf,I);function PEf(a){K(this,a,"ier",-1,null,null)}y(PEf,I);
function QEf(a){K(this,a,"ger",-1,REf,null)}y(QEf,I);function SEf(a){K(this,a,0,-1,null,null)}y(SEf,I);HEf.prototype.ma=function(a){var b={Sz:L(this,1),nca:L(this,2),g1c:M(this,3,!1)};a&&(b.Ga=this);return b};HEf.xf="iar";HEf.prototype.zm=function(){return L(this,1)};var JEf=[2];IEf.prototype.ma=function(a){var b={Sz:L(this,1),oed:jh(th(this,jEf,2),oEf,a)};a&&(b.Ga=this);return b};IEf.xf="llr";IEf.prototype.zm=function(){return L(this,1)};
KEf.prototype.ma=function(a){var b={Sz:L(this,1),nca:L(this,2)};a&&(b.Ga=this);return b};KEf.xf="rar";KEf.prototype.zm=function(){return L(this,1)};D6.prototype.ma=function(a){var b={Sz:L(this,1),zga:L(this,2),name:L(this,3),Mna:L(this,4),X_b:L(this,5),aXb:L(this,6),ZG:L(this,7),Y_b:L(this,8)};a&&(b.Ga=this);return b};D6.xf="lsir";D6.prototype.zm=function(){return L(this,1)};D6.prototype.getName=function(){return L(this,3)};D6.prototype.Ld=function(a){N(this,3,a)};
LEf.prototype.ma=function(a){var b={Sz:L(this,1),knd:L(this,2)};a&&(b.Ga=this);return b};LEf.xf="oau";LEf.prototype.zm=function(){return L(this,1)};MEf.prototype.ma=function(a){var b={Sz:L(this,1)};a&&(b.Ga=this);return b};MEf.xf="eer";MEf.prototype.zm=function(){return L(this,1)};NEf.prototype.ma=function(a){var b={Sz:L(this,1)};a&&(b.Ga=this);return b};NEf.xf="der";NEf.prototype.zm=function(){return L(this,1)};OEf.prototype.ma=function(a){var b={Sz:L(this,1)};a&&(b.Ga=this);return b};OEf.xf="uer";
OEf.prototype.zm=function(){return L(this,1)};PEf.prototype.ma=function(a){var b={Sz:L(this,1)};a&&(b.Ga=this);return b};PEf.xf="ier";PEf.prototype.zm=function(){return L(this,1)};var REf=[1];QEf.prototype.ma=function(a){var b={f1c:jh(th(this,SEf,1),TEf,a)};a&&(b.Ga=this);return b};QEf.xf="ger";n=SEf.prototype;n.ma=function(a){return TEf(a,this)};
function TEf(a,b){var c={xAa:L(b,1),zga:L(b,2),name:L(b,3),C_c:L(b,4),Mna:L(b,5),X_b:L(b,6),aXb:L(b,7),sRc:L(b,8),Otd:L(b,9),xXc:L(b,10),Y_b:L(b,11),xGd:L(b,12),category:L(b,13),summary:L(b,14),rfd:L(b,15),WBd:L(b,16),G2c:L(b,17),mib:L(b,18)};a&&(c.Ga=b);return c}n.getName=function(){return L(this,3)};n.Ld=function(a){N(this,3,a)};n.Wh=function(){return L(this,13)};n.JKa=function(){return null!=L(this,14)};function E6(a,b){this.C=a;this.D=(void 0===b?null:b)||null}function UEf(a){return new E6(L(a,1),L(a,18))};function VEf(a){K(this,a,0,-1,WEf,null)}y(VEf,I);function XEf(a){K(this,a,0,-1,null,null)}y(XEf,I);function YEf(a){K(this,a,0,-1,null,null)}y(YEf,I);function ZEf(a){K(this,a,0,-1,$Ef,null)}y(ZEf,I);function aFf(a){K(this,a,0,-1,null,null)}y(aFf,I);function bFf(a){K(this,a,0,-1,cFf,null)}y(bFf,I);var WEf=[5,7,16,18,37,39];
VEf.prototype.ma=function(a){var b,c={z9c:L(this,1),G9c:(b=O(this,ZEf,2))&&dFf(a,b),V9c:L(this,3),a$c:L(this,4),Ord:lh(this,5),l7c:L(this,6),A9c:lh(this,7),v9c:L(this,8),Z9c:L(this,9),eod:L(this,10),y9c:(b=O(this,aFf,11))&&eFf(a,b),E9c:L(this,14),F9c:M(this,27,!1),u9c:lh(this,16),x9c:L(this,24),C9c:L(this,25),B9c:L(this,26),hLd:L(this,12),eUc:L(this,13),k7c:L(this,15),fBd:L(this,17),Prd:jh(th(this,YEf,18),fFf,a),KSc:(b=O(this,bFf,19))&&gFf(a,b),ocb:M(this,20,!1),$Ad:M(this,21,!1),bBd:M(this,22,!1),
eIc:M(this,23,!0),hBd:M(this,28,!1),m7c:M(this,29,!1),o7c:M(this,30,!1),ofd:L(this,31),gBd:M(this,32,!1),n7c:M(this,33,!1),Pjd:L(this,34),Mjd:L(this,35),dcb:M(this,36,!1),R0c:jh(th(this,XEf,37),hFf,a),p7c:M(this,38,!1),S_c:lh(this,39),cBd:M(this,40,!1),j3c:M(this,41,!1)};a&&(c.Ga=this);return c};XEf.prototype.ma=function(a){return hFf(a,this)};function hFf(a,b){var c={label:L(b,1),ELc:L(b,2)};a&&(c.Ga=b);return c}XEf.prototype.getLabel=function(){return L(this,1)};
YEf.prototype.ma=function(a){return fFf(a,this)};function fFf(a,b){var c={lU:L(b,1),Mfd:L(b,2)};a&&(c.Ga=b);return c}var $Ef=[2];ZEf.prototype.ma=function(a){return dFf(a,this)};function dFf(a,b){var c={eOd:L(b,1),ihd:lh(b,2)};a&&(c.Ga=b);return c}aFf.prototype.ma=function(a){return eFf(a,this)};function eFf(a,b){var c={Cy:L(b,1),mimeType:L(b,2)};a&&(c.Ga=b);return c}aFf.prototype.ql=function(a){N(this,2,a)};var cFf=[2];bFf.prototype.ma=function(a){return gFf(a,this)};
function gFf(a,b){var c={clientId:L(b,1),fDd:lh(b,2)};a&&(c.Ga=b);return c}function iFf(a){K(this,a,0,-1,jFf,null)}y(iFf,I);function F6(a){K(this,a,0,-1,null,null)}y(F6,I);var jFf=[1];iFf.prototype.ma=function(a){var b={Egd:jh(th(this,F6,1),kFf,a)};a&&(b.Ga=this);return b};n=F6.prototype;n.ma=function(a){return kFf(a,this)};function kFf(a,b){var c={Fbd:M(b,1,!1),caption:L(b,2),key:L(b,3),url:L(b,4),checked:M(b,5,!1),enabled:M(b,6,!0)};a&&(c.Ga=b);return c}n.Lh=function(){return L(this,2)};
n.Xm=function(a){N(this,2,a)};n.W9=function(){return null!=L(this,2)};n.getKey=function(){return L(this,3)};n.Qm=function(){return M(this,5,!1)};n.qc=function(a){N(this,5,a)};n.Qa=function(a){N(this,6,a)};function lFf(a){var b=mFf;this.H=a;this.country=this.language=null;this.F="https://clients5.google.com";this.D=null;this.C=new VEf;this.yR=null;this.size=b;this.scrolling="auto"}lFf.prototype.clone=function(){return Vd(this)};function nFf(a){P.call(this);this.F=a;a=x(this.L,this);this.F.D=a;this.D=new un;this.H=new mk;this.C=new mk}y(nFf,P);nFf.prototype.J=0;nFf.prototype.connect=function(){this.F.connect(x(this.D.callback,this.D));this.D.addCallback(x(this.dispatchEvent,this,"ni"))};nFf.prototype.call=function(a,b,c,d){this.D.addCallback(function(){var e={data:b,messageId:this.J};this.H.set(this.J,{hza:c,gza:d});this.J++;this.F.send(a,e)},this)};
function oFf(a,b,c,d){a.D.addCallback(function(){this.F.send("_response",{data:b,messageId:c,result:d})},a)}nFf.prototype.L=function(a,b){if(oa(b))try{var c=JSON.parse(b)||{}}catch(d){return}else c=b;"_response"==a?(a=c,b=this.H.get(a.messageId),this.H.remove(a.xf),(c=a.result)&&Da(b.hza)&&b.hza(a.data),!c&&Da(b.gza)&&b.gza(Error(a.data.message))):pFf(this,a,c)};
function pFf(a,b,c){if(b=a.C.get(b)){var d=x(function(a){oFf(this,a||{},c.messageId,!0)},a);a=x(function(a){var b={};b.message=a&&a.message||"";oFf(this,b,c.messageId,!1)},a);try{b(c.data,d,a)}catch(e){a(e)}}};function qFf(a,b,c){R.call(this,c);this.J=a;this.L=new nFf(this.J);this.C=b;this.H=this.D=null;this.F=b.D}y(qFf,R);n=qFf.prototype;n.getWidth=function(){return $w(this.getElement()).width};n.setWidth=function(a){Yw(this.getElement(),a+"px");this.H.width=a;this.C.size.width=a};n.getHeight=function(){return $w(this.getElement()).height};n.setHeight=function(a){Zw(this.getElement(),a+"px");this.H.height=a;this.C.size.height=a};n.Da=function(){qFf.xa.Da.call(this);Xw(this.getElement(),this.C.size);rFf(this)};
function sFf(a,b){Q(a.F,!b);a.D.style.visibility=b?"visible":"hidden"}function rFf(a){var b=a.qa();a.D=b.Da("DIV");a.D.style.position="absolute";a.F=a.F||b.Da("DIV");sFf(a,!1);var c=a.getElement();b.appendChild(c,a.D);b.appendChild(c,a.F);c3d(a.J,a.D,x(function(a){b.k_(a,{frameborder:0,style:"border: 0; vertical-align: bottom; transform: translateZ(0);",scrolling:this.C.scrolling,width:this.C.size.width,height:this.C.size.height});this.H=a},a));a.L.connect()};function tFf(a){this.C=new lFf(a);this.eb=void 0}var mFf=new cl(735,500);function uFf(a,b){a.C.language=b;return a}n=tFf.prototype;n.ocb=function(a){N(this.C.C,20,a);return this};n.dcb=function(a){N(this.C.C,36,a);return this};function vFf(a,b){N(a.C.C,3,b);return a}function wFf(a,b){N(a.C.C,4,b);return a}function xFf(a){N(a.C.C,12,!0);return a}function yFf(a,b){N(a.C.C,6,b);return a}n.setHeight=function(a){this.C.size.height=a;return this};n.setWidth=function(a){this.C.size.width=a;return this};
function zFf(a,b){N(a.C.C,9,b);N(a.C.C,10,!0);return a}
n.build=function(){var a=this.C.F,b=yk(a+"/webstore/wall/widget","container",this.C.H,"utm_source",uk(window.location.href),"utm_medium","apps-widget","ref",wk(window.location.href));L(this.C.C,15)&&(b=yk(b,"hdpa","true"));if(th(this.C.C,XEf,37)&&0<th(this.C.C,XEf,37).length){for(var c=th(this.C.C,XEf,37),d="",e=0;e<c.length;e++)0!=e&&(d+=","),d+=c[e].getLabel()+":"+L(c[e],2);b=yk(b,"exp",d)}null!=this.C.language&&(b=yk(b,"hl",this.C.language));null!=this.C.country&&(b=yk(b,"gl",this.C.country));
null!=this.C.yR&&(b=yk(b,"authuser",this.C.yR));M(this.C.C,41,!1)&&(b=yk(b,"force_show_apps",""));c={};Td(c,"pu",b);Td(c,"ph",a);Td(c,"tp",1);Td(c,"osh",!0);a=new VY(c,this.eb);return new qFf(a,this.C.clone(),this.eb)};function AFf(a){QN.call(this,a,"")}y(AFf,QN);function G6(a,b){OB.call(this,void 0,!0,b);gA(this,jo(a));this.setVisible(!0);this.Zi=!0;qA(this,sA(new nA,{key:"close",caption:"Close"},!0,!0));xA(this,"close");this.setTitle("Oops")}y(G6,OB);G6.prototype.Ia=function(){G6.xa.Ia.call(this);this.addEventListener("dialogselect",this.C)};G6.prototype.Id=function(){G6.xa.Id.call(this);this.removeEventListener("dialogselect",this.C)};G6.prototype.Fm=function(){G6.xa.Fm.call(this);this.getElement().focus()};G6.prototype.C=function(a){"close"==a.key&&this.setVisible(!1)};function H6(a,b,c,d){var e=L(a,4)+"-polymorphic-"+(L(a,1)||"");Yv.call(this,e);this.C=a;this.V=Bc(b,function(a){return new H6(a,[],!1)},this);this.Qa(this.isEnabled());this.Ka=c;this.Ea=pa(d)?d:!0}v(H6,Yv);H6.prototype.isInstalled=g("Ea");H6.prototype.Ub=function(){(Xu(),tQa).Ub(this)};H6.prototype.isEnabled=function(){return this.V&&(0<this.V.length?!0:!!L(this.C,7))};H6.prototype.getLabel=function(){return this.C.Lh()||L(this.C,10)||""};function BFf(){vm.call(this,"ui")}y(BFf,vm);function CFf(){P.call(this);this.C={};this.C[1]={};this.C[0]={};this.D=new Sv(this);this.Aa(this.D);this.D.subscribe((Xu(),tQa),"action",this.F)}y(CFf,P);CFf.prototype.F=function(a){a.Ka||0<a.V.length?this.dispatchEvent(new BFf(a)):(a=new rEf(L(a.C,4),L(a.C,3),void 0,L(a.C,9)||void 0,void 0,a.C.Tr()||void 0),(Xu(),ju).Ub(a))};function DFf(a,b,c){c=c||EFf();uo(c.location,a);b!=ua&&(a=new P6b(function(){return c?c.closed:!0}),a.TFa=b,a.start(100,-1))}function EFf(){return HA("",{target:"_blank",height:500,width:600,top:(screen.height-500)/2,left:(screen.width-600)/2,scrollbars:!0})};function FFf(a,b,c,d){D.call(this);this.D=a;this.F=c;this.C=d||new GFf}y(FFf,D);n=FFf.prototype;n.HLa=function(a,b,c,d,e,f,h){a=["ruid",Ea({}),this.C.C,this.D,this.C.F,a,this.C.O,b,this.C.D,c,this.C.ZG,e,this.C.Ba,f,this.C.vG,h];a=bp(Fj(dp(I6(this,this.C.V),"POST"),2),a).yq();d&&(Ij(a,x(this.uLb,this,d)),Hj(a,x(this.htb,this,d)));a.$e()};n.cancel=function(a){a=["ruid",Ea({}),this.C.C,this.D,this.C.H,a];bp(Fj(dp(I6(this,this.C.J),"POST"),2),a).yq().$e()};
function HFf(a,b){var c=["ruid",Ea({}),a.C.C,a.D];c=bp(Fj(I6(a,a.C.ea),2),c);b&&(Ij(c,x(a.Mtb,a,b)),Hj(c,x(a.Ltb,a,b)));c.$e()}function IFf(a,b,c,d){b=["ruid",Ea({}),a.C.C,a.D,a.C.D,b];c||b.push("addon_safe_mode",!0);d&&b.push("addon_dry_run",d);bp(dp(I6(a,a.C.La),"POST").setContent(""),b).yq().$e()}n.uLb=function(a,b){b=b.qf();b=new HEf(b[0]);a(b)};n.htb=function(a){var b=new HEf;N(b,1,!1);a(b)};n.Mtb=function(a,b){b=b.qf();b=new IEf(b[0]);a(b)};n.Ltb=function(a){var b=new IEf;N(b,1,!1);a(b)};
n.wLb=function(a,b){b=b.qf();b=new KEf(b[0]);a(b)};n.$zb=function(a){var b=new KEf;N(b,1,!1);a(b)};function JFf(a,b,c){b=["ruid",Ea({}),"storeitemid",b.C];b=bp(Fj(I6(a,a.C.oa),2),b);c&&(Ij(b,x(a.hub,a,c)),Hj(b,x(a.gub,a,c)));b.$e()}n.hub=function(a,b){b=b.qf();b=new D6(b[0]);a(b)};n.gub=function(a){var b=new D6;N(b,1,!1);a(b)};function KFf(a,b){var c=["ruid",Ea({}),a.C.C,a.D];Hj(Ij(bp(Fj(I6(a,"/scripts/getitems"),1),c),x(a.trb,a,b)),ua).$e()}
function LFf(a,b,c){b=["ruid",Ea({}),a.C.C,a.D,"storeitemid",b.C];b=bp(dp(I6(a,"/scripts/installitem"),"POST"),b).yq();c&&(Ij(b,x(function(a,b){b=b.qf();b=new PEf(b[0]);a(b)},a,c)),a=new PEf,N(a,1,!1),Hj(b,Fa(c,a)));b.$e()}n.trb=function(a,b){b=b.qf();b=new QEf(b[0]);a(b)};
function MFf(a,b,c){function d(a,b){b=b.qf();b=new OEf(b[0]);a(b)}b=["ruid",Ea({}),a.C.C,a.D,"storeitemid",b.C];b=bp(dp(I6(a,"/scripts/uninstallitem"),"POST"),b).yq();c&&(Ij(b,x(d,a,c)),a=new OEf,N(a,1,!1),Hj(b,Fa(c,a)));b.$e()}n.GCa=function(a,b,c,d,e){a=["ruid",Ea({}),this.C.C,this.D,this.C.D,e,"extensionid",a,"cwsid",b.C,"justInstalled",d];null!=b.D&&a.push("appid",b.D);b=bp(Fj(dp(I6(this,"/scripts/enableitem"),"POST"),1),a).yq();c&&(Ij(b,x(this.Kpb,this,c)),Hj(b,x(this.Jpb,this,c)));b.$e()};
n.Kpb=function(a,b){b=b.qf();b=new MEf(b[0]);a(b)};n.Jpb=function(a){var b=new MEf;N(b,1,!1);a(b)};n.m6a=function(a,b,c,d){a=["ruid",Ea({}),this.C.C,this.D,this.C.D,d,"extensionid",a,"cwsid",b.C];null!=b.D&&a.push("appid",b.D);b=bp(Fj(dp(I6(this,"/scripts/disableitem"),"POST"),1),a).yq();c&&(Ij(b,x(this.pob,this,c)),Hj(b,x(this.oob,this,c)));b.$e()};n.pob=function(a,b){b=b.qf();b=new NEf(b[0]);a(b)};n.oob=function(a){var b=new NEf;N(b,1,!1);a(b)};
function NFf(a,b,c,d){b=["ruid",Ea({}),a.C.F,b,a.C.C,a.D];d&&(Mc(b,a.C.ZG),Mc(b,d));d=bp(Fj(I6(a,a.C.Ea),2),b).yq();c&&(Ij(d,x(a.vLb,a,c)),Hj(d,x(a.jwb,a,c)));d.$e()}n.vLb=function(a,b){b=b.qf();b=new LEf(b[0]);a(b)};n.jwb=function(a){var b=new LEf;N(b,1,!1);a(b)};function I6(a,b){return cp(a.F.jf(b)).setTimeout(4E4)}
function GFf(a,b,c,d,e,f,h,k,l,q,t,u,w,z,J,S,ca,ba){D.call(this);this.C=a||"id";this.F=c||"lib";this.O=d||"func";this.D=e||"ctx";this.H=f||"pid";this.ZG=S||"eei";this.Ba=ca||"usit";this.vG=na(ba)?ba:"did";this.L=h||"ca";this.V=k||"/scripts/invoke";this.J=l||"/scripts/cancel";this.ea=q||"/scripts/libraries";this.Ka=t||"/scripts/resume";this.La=w||"/scripts/uiready";this.oa=z||"/scripts/lookupstoreitem";this.Ea=J||"/scripts/oauthurl"}y(GFf,D);function OFf(a,b){OB.call(this);this.C=b.build();qA(this,z0a());this.setTitle(a)}y(OFf,OB);function PFf(a){var b=VB();b=jd(b)?NaN:Number(b);a=new tFf(a);var c=tc(A(),"docs-cwsd");a.C.F=c;isNaN(b)||(a.C.yR=b);return a}OFf.prototype.Da=function(){OFf.xa.Da.call(this);this.C.render(this.Nb());tv(jA(this))};OFf.prototype.Fm=function(){OFf.xa.Fm.call(this);try{C.Hb&&this.qa().Yb().body.focus(),this.getElement().focus()}catch(a){}};OFf.prototype.getView=g("C");function QFf(a){D.call(this);this.C=a;this.F=a.L;a=x(this.yTb,this);this.F.C.set("beforeInstall",a);a=x(this.rTb,this);this.F.C.set("afterInstall",a);a=x(this.BUb,this);this.F.C.set("launch",a);a=x(this.ugb,this);this.F.C.set("getStoreConfig",a);a=x(this.E9b,this);this.F.C.set("onRendered",a);a=x(this.Sfb,this);this.F.C.set("getPopupUrl",a);a=x(this.aUb,this);this.F.C.set("onEscape",a);a=x(this.EUb,this);this.F.C.set("onManageMenu",a);a=x(this.DUb,this);this.F.C.set("onManageMenuEvent",a);a=x(this.zTb,
this);this.F.C.set("beforeNavigate",a)}y(QFf,D);n=QFf.prototype;n.getView=g("C");n.yQa=da();n.YPa=function(a){a(!0)};n.cra=da();n.nQa=function(a,b){b(null)};n.ira=da();n.uQa=function(a,b){b(null)};n.tQa=da();n.Rqa=function(){this.F.call("navigate",{navigatePage:"userItems",forceRefresh:!1})};function RFf(a,b,c){var d={};d.itemId=b;a.F.call("uninstall",d,c,ua)}n.zTb=function(a,b){b({shouldNavigate:!0})};n.E9b=function(){sFf(this.C,!0);this.yQa()};
n.yTb=function(a,b){this.YPa(function(a){var c={};c.shouldInstall=a;b(c)})};n.rTb=function(a,b){this.cra(a.itemId,!!a.installResult);b()};n.BUb=function(a,b){b()};n.ugb=function(a,b){a={};a.storeConfigProto=this.C.C.C.serialize();b(a)};n.Sfb=function(a,b){this.nQa(a.itemId,function(a){var c={};c.installFlowPopupUrl=a;b(c)})};n.aUb=function(a,b){this.ira();b()};n.EUb=function(a,b){this.uQa(a.itemId,function(a){var c={};c.manageMenuProto=a.serialize();b(c)})};n.DUb=function(a){this.tQa(a.itemId,a.manageMenuEventKey)};function SFf(a,b,c){QFf.call(this,a.getView());this.H=a;this.D=b;this.L=this.O=this.J=null;this.V=!!c;this.H.Zi=!0}y(SFf,QFf);n=SFf.prototype;
n.uQa=function(a,b){a=J6(this.D,new E6(a));var c=new iFf,d=new F6;d.Xm("Remove");N(d,3,"remove");if(null!=a){var e=this.D;var f=2==e.J?!1:1==e.J?!(!L(a,10)||!L(a,9)):!0;e=new F6;N(e,1,!0);var h=new F6;h.Xm("Use in this document");N(h,3,"useInDoc");h.qc(!!L(a,4)||!!L(a,12));h.Qa(f);var k=new F6;k.Xm("Help");N(k,3,"help");h=[h,k];L(a,9)&&(h.push(e),L(a,8)&&(k=new F6,k.Qa(f),k.Xm("Settings"),N(k,3,"settings"),h.push(k)),f=new F6,f.Xm("Report an issue"),N(f,3,"reportIssue"),h.push(f),L(a,10)||h.push(e,
d));wh(c,1,h)}else wh(c,1,[d]);b(c)};
n.tQa=function(a,b){var c=new E6(a),d=J6(this.D,c);switch(b){case "remove":b=x(function(){var a=d?L(d,2):null;TFf(this.D,a,c)},this);RFf(this,a,b);break;case "settings":UFf(this.D,L(d,2));E(this.H);break;case "useInDoc":a=UEf(d);L(d,4)||L(d,12)?VFf(this.D,L(d,2),a,function(a){a&&(N(d,4,!1),N(d,12,!1))}):WFf(this.D,L(d,2),a,function(a){a&&N(d,4,!0)});break;case "reportIssue":this.D.Va(c,L(d,2),d.getName(),L(d,6)||void 0,L(d,11)||void 0);break;case "help":XFf(this.D,c)}};
n.yQa=function(){this.V&&this.Rqa();YFf(this.D)};n.nQa=function(a,b){this.D.J?(ZFf(this.D),b(null)):($Ff(this.D,new E6(a),x(this.Pjb,this,b)),a=this.H.kja(),this.H.Zi=!1,this.H.setVisible(!1),this.H.Zi=a)};n.YPa=function(a){null===this.L||null===this.J?a(!1):this.L?a(!0):this.D.ea(this.J,function(b){a(!(null===b||na(b)))},this.O||void 0)};n.cra=function(a,b){E(this.H);b&&null!==this.J&&aGf(this.D,this.J,new E6(a))};n.ira=function(){this.H.setVisible(!1)};
n.Rqa=function(){this.F.call("filterOptions",{showFilterOptions:!1});SFf.xa.Rqa.call(this)};n.Pjb=function(a,b,c,d){this.J=b||null;this.O=d||null;null!=b?this.D.ea(b,x(this.yLb,this,a),d||void 0):(new G6("Unable to install add-on"),a(null))};n.yLb=function(a,b){null===b?a(null):(this.L=!na(b),a(this.L?null:b))};function bGf(a,b,c,d,e,f,h,k,l,q,t,u){D.call(this);this.Ra=q?MYb(q):void 0;this.Oa=q?NYb(q):void 0;this.O=a;this.C=d;this.Wa=e;this.Sa=b;this.Ba=f;this.F=h;this.oa=k;this.D=[];this.J=l;this.H=null;this.V=new UK("mae-show_addons_menu_promo");Cw(c,this.V,"mae-show_addons_menu_promo");this.Ea=new AFf("mae-show_addons_promo");Cw(c,this.Ea,"mae-show_addons_promo");this.La=t||null;this.Ka=u||null}y(bGf,D);
function cGf(a,b,c,d,e,f,h){a.C.nE();if(b){var k=x(function(){var a=dGf(this.C);a&&eGf(a,b);LFf(this.F,d,x(function(a){a.zm()?aGf(this,b,d):(fGf(this.C.C,"Server error. Unable to load third party application"),gGf(this))},this))},a);hGf(a,b,c,k,e,f,h)}else new G6("Add-on not found. Try again, or check back later."),f&&f.close()}
function iGf(a,b,c){if(a.J)ZFf(a),gGf(a);else if(jGf(a,b)){var d=J6(a,b).getName();kGf(a.C.C,ld(d+" is already installed"));gGf(a)}else{var e=c?null:EFf();K6(a.C);$Ff(a,b,x(function(a,d,k){cGf(this,a,d,b,c,e,k)},a))}}function hGf(a,b,c,d,e,f,h){function k(){l(b,function(a){a||d()},h)}var l=x(a.ea,a);a.ea(b,function(a){a?e?lGf(a,c+" needs your permission to run.",k,"Let's get started"):DFf(a,k,f):(f&&f.close(),d())},h)}
bGf.prototype.L=function(a,b,c,d,e){if(this.O==(BA(),yA))var f="GOOGLE_DOCUMENT";else if(this.O==(BA(),T0a))f="GOOGLE_FORM";else if(this.O==(BA(),zA))f="GOOGLE_SPREADSHEET";else if(this.O==(BA(),AA))f="GOOGLE_SLIDES";else throw Error("Unsupported document type for webstore widget ["+this.O+"]");if(1136>iv().width)var h=735,k=Math.min(455,iv().height-176);else h=975,k=Math.min(603,iv().height-176);var l="scrollbars=yes,width=600,height=500,left="+(Math.max(0,Math.floor((document.body.clientWidth-600)/
2))+(window.screenLeft||window.screenX))+",top="+(Math.max(0,Math.floor((document.body.clientHeight-500)/2))+(window.screenTop||window.screenY));b=xFf(zFf(vFf(yFf(PFf(f).setHeight(k),!!e),b||"Free"),l)).setWidth(h);a&&N(b.C.C,1,a.C);c&&wFf(b,c);this.Oa&&(b.C.country=this.Oa);this.Ra&&uFf(b,this.Ra);e?(a=this.D.map(function(a){return L(a,1)}),N(b.C.C,5,a||[])):(a=this.D.filter(function(a){return L(a,10)&&L(a,9)}).map(function(a){return L(a,1)}),N(b.C.C,5,a||[]));this.H&&!this.H.isDisposed()&&this.H.dispose();
this.H=new OFf(d||"Add-ons",b);T(kA(this.H),"webstore-widget");d=new SFf(this.H,this,e);this.H.Aa(d);this.Sa.oi(this.H);this.H.setVisible(!0);mGf(this)};function UFf(a,b){K6(a.C);var c=x(function(a,b){this.C.nE();a&&a(b)},a,void 0);O0d(a.Ba.C,x(a.F.HLa,a.F,b,"doSettings",a.oa().getState()||void 0,c))}function WFf(a,b,c,d){K6(a.C);O0d(a.Ba.C,x(a.F.GCa,a.F,b,c,x(function(b,d){if(d.zm()){var e=J6(a,c);e&&N(e,4,!0);YFf(a)}a.C.nE();b&&b(d.zm())},a,d),void 0,a.oa().getState()||void 0))}
function VFf(a,b,c,d){K6(a.C);O0d(a.Ba.C,x(a.F.m6a,a.F,b,c,x(function(d,f){if(f.zm()){(Xu(),pQa).Ub(b);var e=J6(a,c);e&&(N(e,4,!1),N(e,12,!1));YFf(a)}a.C.nE();d&&d(f.zm())},a,d),a.oa().getState()||void 0))}function TFf(a,b,c){MFf(a.F,c,x(function(a,e){if(e.zm()&&b){(Xu(),pQa).Ub(b);var d=this.D.findIndex(function(a){return c.C===L(a,1)});-1!=d&&Qc(this.D,d);(d=dGf(this.C))&&Sd(d.ea,b)}YFf(this);a(e.zm())},a,ua))}
bGf.prototype.Va=function(a,b,c,d,e){e?HA(e):(nGf(this.C,x(function(e,h){var f=this.F,l=x(this.C.C2b,this.C,c,h,d),q=x(this.C.B2b,this.C);bp(Hj(Ij(Fj(dp(I6(f,"/scripts/sendissuereport"),"POST"),1),Tj(l)),Tj(q)),["ruid",Ea({}),f.C.C,f.D,f.C.F,b,"storeitemid",a.C,"issuedesc",e,"includeUserInfo",h]).yq().$e()},this),c),mGf(this))};
function XFf(a,b){var c=J6(a,b);if(null!==c){var d=x(a.Va,a,b,L(c,2),c.getName(),L(c,6)||void 0,L(c,11)||void 0);b=x(a.L,a,b);var e=a.C,f=c.getName(),h=vd(L(c,7)),k=L(c,6)||void 0;c=L(c,11)||void 0;e.J&&!e.J.isDisposed()&&(PB(e.F,e.J),e.J.dispose());e.J=new oGf(f,h,d,b,k,c);e.J.Zi=!0;e.F.oi(e.J);e.J.setVisible(!0);mGf(a)}}
function ZFf(a){if(1==a.J)var b="Add-ons aren't allowed in your domain. Talk to your domain administrator for more information.";else if(2==a.J)b="Add-ons aren't allowed while in safe mode.";else return;t0d(a.Sa,"Oops",b,void 0,void 0,"Close")}function $Ff(a,b,c){JFf(a.F,b,function(a){a.zm()?c(L(a,2),a.getName(),L(a,7)):c(null,null,null)})}bGf.prototype.ea=function(a,b,c){NFf(this.F,a,function(a){b(a.zm()?L(a,2):null)},c)};
function aGf(a,b,c){K6(a.C);var d=x(function(a){this.C.nE();a.zm()?YFf(this,x(function(){var a=J6(this,c),b=dGf(this.C);b=b?b.isVisible():!1;if(a&&!b){b=a.getName();var d=vd(L(a,7));a=vd(L(a,6));this.C.dispatchEvent(new pGf(b,d,a))&&(a=new qGf(b,d,a),a.render(),a.setVisible(!0))}},this)):(fGf(this.C.C,"Unable to install add-on"),gGf(this))},a);O0d(a.Ba.C,x(a.F.GCa,a.F,b,c,d,!0,a.oa().getState()||void 0))}
function YFf(a,b){KFf(a.F,x(function(a,b){b=th(b,SEf,1);Lc(this.D);b=ja(b);for(var c=b.next();!c.done;c=b.next())this.D.push(c.value);rGf(this);gGf(this);a()},a,b||ua))}
function rGf(a){for(var b=a.Wa,c=Sc(a.D),d=0;d<c.length;++d){var e=c[d],f=L(e,2);if(!b.C[1][f]){var h=e;e=new z6;var k=L(h,1);N(e,1,k);e.Xm(h.getName());k=L(h,2);N(e,4,k);e.Qa(!0);k=h.getName();N(e,10,k);N(e,11,1);h=!(!L(h,10)&&!L(h,9));e=new H6(e,[],!0,h);e.setVisible(!0);b.C[M(e.C,11,0)][f]=e;b.dispatchEvent("si")}}if(b=a.C.O)if(Kc(a.D)&&!a.V.getValue())a=a.O,nk(b.F.F,"mae-promo-id")||(a=new sGf(a),a.render(),c=new hy(""),c.Ie("mae-promo-id"),c.Dd("script-promo-menu-item"),c.setContent(a.getElement()),
Vz(b.O,c,(Xu(),sQa),void 0,void 0,tGf(3)),b.C.Hc(),b.F.Hc(),uGf(b.F,c)),(Xu(),ou).Qa(!1),vGf(b);else{c=Sc(a.D);if(b.J){Zc(c,b.La);e=new mk;Pqa(e,b.C.F);b.F.Hc();b.C.Hc();d=[];for(f=0;f<c.length;++f){k=c[f];var l=L(k,2),q=!(!L(k,10)&&!L(k,9));d.push(l);if(h=e.get(l))t=h.fc(),q&&(l=t.Rc(0),q=wGf(UEf(k)),l&&l.getId()==q&&(t.Hm(0).dispose(),2==t.Uc()&&(t.Rc(0),t.Hm(0).dispose())));else{h=new eB("");h.Ie(l);h.Qa(xGf(b,!0,k));var t=new my;q||yGf(b,t,k);zGf(b,t,l,[],k);h.Ef(t)}k=k.getName();t=nv("span");
t.appendChild(ov(k));h.setContent(t);uGf(b.C,h)}for(f=0;f<b.V.length;++f)uGf(b.C,e.get(b.V[f]));if(b.L)for(e=e.hf(),h=0;h<e.length;++h)if(0>d.indexOf(e[h])&&0>b.V.indexOf(e[h])&&(k=b.oa[e[h]])){for(f=0;f<k.length;++f)b.L.zL(k[f]);delete b.oa[e[h]]}(Xu(),ou).Qa(!!c.length);vGf(b)}a.Ka&&a.Ka.Ko(!!a.D.length)}}
function gGf(a){var b=dGf(a.C);if(b){var c=Sc(a.D),d=a.J;b.D=[];for(var e=0;e<c.length;e++){var f=c[e];if(L(f,12)||L(f,4))H0d(b.D,f,b.Scb),b.J&&!L(f,12)&&(b.J=!1)}(Xu(),qu).Qa(0<b.D.length);b.Ea=0==d;b.Ba=!0;b.oa=1==b.D.length&&null!=AGf(b);b.Qb()&&BGf(b);a.La&&a.La.Ko(0<b.D.length)}}function J6(a,b){return a.D.find(function(a){return b.C===L(a,1)})}function CGf(a,b){return a.D.find(function(a){return L(a,2)===b})}function jGf(a,b){a=J6(a,b);return!!a&&!!L(a,9)}
function mGf(a,b){if(b&&(b=CGf(a,b),null!=b&&L(b,10)&&L(b,9))){var c=L(b,1);b=vd(RYb(a.Ea)).split(",");if(!Jc(b,c)){b=a.Ea;var d=[c];c=vd(RYb(b)).split(",");d=Lda(c,d);Wc(d);c!=d&&SYb(b,d.join())}}!a.V.getValue()&&(a.V.setValue(!0),Kc(a.D)&&(b=a.C.O))&&((c=gv("docs-menu-superscript",b.H.getElement()))&&bx(c,0),b.F.Hc(),vGf(b),rGf(a))};function DGf(a,b,c,d,e,f,h,k,l,q,t,u,w){this.H=a;this.O=b;this.L=c;this.ea=d;this.V=e;this.oa=f;this.Ka=h;this.D=k;this.C=l;this.J=q;this.Ba=t;this.Ea=u;this.F=w}function EGf(a,b){a=a.L;if(b){a=new Gk(a);var c=a.C;c+=ed(c,"/")?"":"/";ed(c,"/start/")&&(c=c.replace("start/",""));c+=Tda("d/%s/edit",b);Kk(a,c);a=a.toString()}return a};function tGf(a,b){var c=new Ih,d=new H8c;if(b){var e=L(b,1);N(d,1,e);b=L(b,12);N(d,2,b)}b=sc(A(),"docs-tcmt");e=!!b;N(d,3,e);e&&N(d,4,b);uh(c,73,d);return Yx(Zx(new Xx,c),a).build()};function FGf(a){vm.call(this,"paep");this.F=new xEf(a)}y(FGf,C6);FGf.prototype.C=g("F");function GGf(a){vm.call(this,"rfep");this.F=new EEf(a)}y(GGf,C6);GGf.prototype.C=g("F");function HGf(a){vm.call(this,"sfep");this.F=new yEf(a)}y(HGf,C6);HGf.prototype.C=g("F");function IGf(a){vm.call(this,"step");this.F=new zEf(a)}y(IGf,C6);IGf.prototype.C=g("F");function JGf(a){vm.call(this,"saep");this.F=new CEf(a)}y(JGf,C6);JGf.prototype.C=g("F");function KGf(a){vm.call(this,"snep");this.F=new DEf(a)}y(KGf,C6);KGf.prototype.C=g("F");function LGf(a){vm.call(this,"spep");this.F=new AEf(a)}y(LGf,C6);LGf.prototype.C=g("F");function MGf(a){vm.call(this,"stbep");this.F=new FEf(a)}y(MGf,C6);MGf.prototype.C=g("F");function NGf(a){vm.call(this,"sttep");this.F=new B6(a)}y(NGf,C6);NGf.prototype.C=g("F");function OGf(){P.call(this);this.C=null}y(OGf,P);OGf.prototype.bind=function(a){this.C=a;this.C.subscribe("13",this.D,this)};
OGf.prototype.D=function(a){za(a);switch(a[0]){case "amep":a=new GEf(a);this.dispatchEvent(a);break;case "paep":a=new FGf(a);this.dispatchEvent(a);break;case "rfep":a=new GGf(a);this.dispatchEvent(a);break;case "sfep":a=new HGf(a);this.dispatchEvent(a);break;case "step":a=new IGf(a);this.dispatchEvent(a);break;case "saep":a=new JGf(a);this.dispatchEvent(a);break;case "snep":a=new KGf(a);this.dispatchEvent(a);break;case "spep":a=new LGf(a);this.dispatchEvent(a);break;case "stbep":a=new MGf(a);this.dispatchEvent(a);
break;case "sttep":a=new NGf(a),this.dispatchEvent(a)}};OGf.prototype.Ma=function(){this.C&&this.C.unsubscribe("13",this.D,this);OGf.xa.Ma.call(this)};function PGf(a,b){P.call(this);this.Na=new en(this);this.Aa(this.Na);this.C={};this.D=a;this.F=b}y(PGf,P);n=PGf.prototype;n.start=function(){this.Na.R(this.F,"sfep",x(this.WNa,this));this.Na.R(this.F,"step",x(this.tLb,this))};function QGf(a,b,c,d){d=x(a.sLb,a,b,ua,d||ua);a=a.D;b=["ruid",Ea({}),a.C.C,a.D,a.C.H,b,a.C.L,c];b=bp(Fj(dp(I6(a,a.C.Ka),"POST"),2),b).yq();d&&(Ij(b,x(a.wLb,a,d)),Hj(b,x(a.$zb,a,d)));b.$e()}
n.rLb=function(a,b,c,d,e,f){f.zm()?(a=L(f,2),this.C[a]=new RGf(a,b,d,e),c(a,M(f,3,!1))):(b=new yEf,N(b,2,6),e(b))};n.sLb=function(a,b,c,d){d.zm()?b():(c(),b=new yEf,N(b,1,a),N(b,2,6),this.WNa(new HGf(b.gg())))};n.tLb=function(a){a=a.C();var b=L(a,1);if(Nd(this.C,b)){var c=Ud(this.C,b);(0,c.qLb)(a);c.dispose();Sd(this.C,b)}};n.WNa=function(a){a=a.C();var b=L(a,1);if(Nd(this.C,b)){var c=Ud(this.C,b);(0,c.Zcb)(a);c.dispose();Sd(this.C,b)}a="Google Apps Script: "+a.Xg();window.console.log(a)};
n.Ma=function(){me(this.C);PGf.xa.Ma.call(this)};function RGf(a,b,c,d){D.call(this);this.C=b;this.qLb=c;this.Zcb=d}y(RGf,D);RGf.prototype.getFunctionName=g("C");function SGf(a,b,c){b=c||b;return V('<div class="'+W(a.Qz)+'" aria-labelledby="title'+W(a.id)+'" tabindex="0" role="region"><div class="'+W(a.YFb)+'"><div class="'+W(a.T3)+'" id="title'+W(a.id)+'"></div><div class="'+W(a.C4a)+'" tabindex="0" title="'+W(wz("Close sidebar"))+'" aria-label="'+W(wz("Close sidebar"))+'" role="button">'+U($B({icon:a.zha},b))+'</div></div><div class="'+W(a.fL)+'"></div></div>')}
function TGf(a){return V('<div class="'+W("docs-script-button-bar-text")+" "+W("docs-titlebar-button")+" "+W("goog-inline-block")+'" tabindex="0">'+U(a.caption)+"</div>")}function UGf(a){return V('<div class="'+W("docs-script-button-bar-bubble-content")+'">'+U(a.text)+"</div>")}
function VGf(a){return V('<div class="'+W("script-promo-menu-item-content")+'"><div class="'+W("script-promo-menu-item-icon")+'" aria-hidden="true"><img src="//ssl.gstatic.com/docs/common/'+W(a.iconName)+'.svg"/></div><div class="'+W("script-promo-menu-item-text")+'"><div class="'+W("script-promo-menu-item-title")+'">'+U(a.title)+'</div><div class="'+W("script-promo-menu-item-description")+'">'+U(a.description)+"</div></div></div>")}
function WGf(a){return V('<div class="'+W("func-entry")+'" aria-checked="false" role="radio" tabindex="-1"><div class="'+W("goog-inline-block")+" "+W("func-entry-rb")+'">&nbsp;</div><div class="'+W("goog-inline-block")+" "+W("func-entry-func")+'">'+U(a.functionName)+'</div><div class="'+W("goog-inline-block")+" "+W("func-entry-lib")+'">'+U(a.Rca)+"</div></div>")}
function XGf(a){var b='<div class="'+W("script-help-dialog-content")+'"><div class="'+W("script-help-dialog-content-left")+" "+W("goog-inline-block")+'"><div class="'+W("script-help-dialog-content-section")+'" tabindex="0"><div class="'+W("script-help-dialog-content-title")+'">';b=b+"Getting started"+('</div><div class="'+W("script-help-dialog-content-description")+'">'+U(a.description)+'</div></div></div><div id="'+W(a.Gf.G4)+'" class="'+W("script-help-dialog-buttons")+" "+W("goog-inline-block")+
'"></div></div>');return V(b)}function YGf(a){var b='<div class="'+W("script-postinstallbubble-content")+'"><div id="'+W(a.Gf.sK)+'" class="'+W("script-postinstallbubble-title")+'">'+U(a.title)+'</div><div id="'+W(a.Gf.bX)+'" class="'+W("script-postinstallbubble-description")+'">'+U(a.description);a.EB&&(b+=" ",a='<a href="'+W(Ez(a.EB))+'" target="_blank">Learn more</a>',b+=a);return V(b+"</div></div>")}
function ZGf(a){var b='<p class="'+W("script-reportissue-dialog-description-label")+'" tabindex="0">',c="Describe the issue for the creators of <strong>"+(U(a.Nja)+"</strong>:");b=b+c+('</p><textarea class="'+W("jfk-textinput")+" "+W("script-reportissue-dialog-description")+'"></textarea><p class="'+W("script-reportissue-dialog-disclaimer")+'" tabindex="0">');b=b+"Only this description will be sent, no information from your open document."+('</p><div class="'+W("script-reportissue-dialog-nonanonymous")+
'" tabindex="0"><div class="'+W("script-reportissue-dialog-nonanonymous-control")+" "+W("goog-inline-block")+'"><div class="'+W("script-reportissue-dialog-nonanonymous-checkbox")+" "+W("jfk-checkbox")+'"></div></div><div class="'+W("script-reportissue-dialog-nonanonymous-label")+" "+W("goog-inline-block")+'"><div class="'+W("script-reportissue-dialog-nonanonymous-optional-text")+" "+W("goog-inline-block")+'">');b+="(Optional)</div> ";a="Include your name and email address so the creators of <strong>"+
(U(a.Nja)+" </strong>can follow up.");b=b+a+"</div></div>";return V(b)}
function $Gf(a,b,c){b=c||b;a=a||{};c='<div class="'+W("func-actions")+'">';c+=U(TA({id:"func-action-new",content:Bz("New"),style:0},b));c+=U(TA({id:"func-action-run",content:Bz("Run"),style:0,Ad:"jfk-button-collapse-right"},b));c+=U(TA({id:"func-action-edit",content:Bz("Edit..."),style:0,Ad:"jfk-button-collapse-left"},b));c+=U(TA({id:"func-action-reload",content:Bz(""+U($B({icon:Az(a.kc?"docs-icon-img docs-icon-reload-rtl":"docs-icon-img docs-icon-reload")},b))),style:0,width:1,title:Az("Reload")},
b));c+='</div><div class="'+W("func-header")+'"><div class="'+W("func-header-rb")+" "+W("goog-inline-block")+'"></div><div class="'+W("func-header-func")+" "+W("goog-inline-block")+'">';c=c+"Function"+('</div><div class="'+W("func-header-lib")+" "+W("goog-inline-block")+'">');c=c+"Script"+('</div></div><div class="'+W("func-entries")+'" role="radiogroup" tabindex="0"></div>');return V(c)}function aHf(){var a='<div class="'+W("func-loading")+'">';return V(a+"Fetching scripts...</div>")}
function bHf(){var a='<div class="'+W("func-none")+'">';return V(a+"No scripts found</div>")};function cHf(){}y(cHf,Lx);va(cHf);cHf.prototype.dc=m("func-entry");cHf.prototype.Qg=m(!1);cHf.prototype.Da=function(a){return oz(WGf,{functionName:a.getFunctionName(),Rca:a.TIb},void 0,a.qa())};function L6(a,b,c,d,e,f){Ox.call(this,null,d||cHf.getInstance(),e);this.yMa=a;this.C=na(f)?f:null;this.TIb=b;this.D=c;this.kf(16,!0);this.kf(32,!0);Tx(this,16,!0);Sx(this,16,!1)}y(L6,Ox);L6.prototype.Ar=function(a){L6.xa.Ar.call(this,a);a&&this.getElement()&&this.getElement().focus()};L6.prototype.Tr=g("C");L6.prototype.getFunctionName=g("D");L6.prototype.jc=function(a){L6.xa.jc.call(this,a);this.qc(a);this.getElement()&&Dv(this.getElement(),a)};function M6(a,b){OB.call(this,void 0,void 0,a);this.O=b||!1;this.lr=new Vy;this.Aa(this.lr);this.Xd=new yx;this.Aa(this.Xd);this.J=new UA("");this.Aa(this.J);this.C=new UA("");this.Aa(this.C);this.F=new UA("");this.Aa(this.F);this.L=new UA("");this.Aa(this.L);a=new nA(a);a.set("close","Close",!1,!0);mA(this,!1);qA(this,a);this.setTitle("Script manager")}y(M6,OB);n=M6.prototype;
n.reset=function(a){this.lr.clear();this.Cd(!0);0===a?(a=oz(aHf,{},void 0,this.qa()),a=new Ox(a),a.kf(32,!1),this.Ha(a,!0)):1===a&&(a=oz(bHf,{},void 0,this.qa()),a=new Ox(a),a.kf(32,!1),this.Ha(a,!0))};n.focus=function(){if(this.Qb()&&0<this.lr.Xh()){var a=this.lr.bf();a&&a.Ar(!0)}else M6.xa.focus.call(this)};n.Cd=function(a){a=M6.xa.Cd.call(this,a);this.lr.clear();dHf(this);return a};
n.Mf=function(a,b,c){M6.xa.Mf.call(this,a,b,c);a instanceof L6&&(b=a.isChecked(),this.lr.Vc(a),1==this.lr.Xh()||b)&&(PYa(this.lr,a),a.Ar(!0));dHf(this)};n.Da=function(){M6.xa.Da.call(this);var a=this.Nb();T(a,"script-explorer-contents");mz(a,$Gf,{kc:this.O});a=vv(wv(a));this.J.Xa(a[0]);this.F.Xa(a[1]);this.C.Xa(a[2]);this.L.Xa(a[3]);xA(this,"run")};
n.Ia=function(){M6.xa.Ia.call(this);zx(this.Xd,this.Nb());dHf(this);this.addEventListener("dialogselect",Oj(!0));Am(this,"action",this.hIa,void 0,this);Am(this.Xd,"key",this.GIa,void 0,this);var a=new oA("new",this.J.getContent());Am(this.J,"action",x(this.dispatchEvent,this,a));a=new oA("run",this.F.getContent());Am(this.F,"action",x(this.dispatchEvent,this,a));a=new oA("edit",this.C.getContent());Am(this.C,"action",x(this.dispatchEvent,this,a));a=new oA("reload",this.L.getContent());Am(this.L,"action",
x(this.dispatchEvent,this,a))};n.Id=function(){M6.xa.Id.call(this);Ax(this.Xd);Em(this,"action",this.hIa,void 0,this);Em(this.Xd,"key",this.GIa,void 0,this);Gm(this.J);Gm(this.F);Gm(this.C);Gm(this.L)};n.Nb=function(){var a=M6.xa.Nb.call(this),b=vv(a);return 0<b.length?b[2]:a};n.hIa=function(a){dHf(this);a.target instanceof L6&&(PYa(this.lr,a.target),a.target.Ar(!0))};
n.GIa=function(a){var b=this.lr.Xh();if(0<b)switch(a.keyCode){case 38:this.lr.Xe(Wj(this.lr.Mh()-1,b));a.preventDefault();this.focus();break;case 40:this.lr.Xe(Wj(this.lr.Mh()+1,b)),a.preventDefault(),this.focus()}};function dHf(a){var b=!!a.lr.bf();a.F.setVisible(b);a.C.setVisible(b)};function eHf(){D.call(this);this.F=new mk}y(eHf,MW);eHf.prototype.C=function(){return this.F.Od()};function uGf(a,b){a.F.set(b.getId(),b)}eHf.prototype.Hc=function(){this.F.clear()};function sGf(a,b){R.call(this,b);this.C=a}y(sGf,R);
sGf.prototype.Da=function(){sGf.xa.Da.call(this);var a=this.C==(BA(),yA)?"Do more with Docs":this.C==(BA(),T0a)?"Do more with Forms":this.C==(BA(),zA)?"Do more with Sheets":this.C==(BA(),AA)?"Do more with Slides":"Do more with Docs",b=this.C==(BA(),yA)?"Looking for even more Docs features? Get a few add-ons.":this.C==(BA(),T0a)?"Looking for even more Forms features? Get a few add-ons.":this.C==(BA(),zA)?"Looking for even more Sheets features? Get a few add-ons.":this.C==(BA(),AA)?"Looking for even more Slides features? Get a few add-ons.":
"Looking for even more Docs features? Get a few add-ons.",c=this.C==(BA(),yA)?"addon_docs_promo":this.C==(BA(),T0a)?"addon_forms_promo":this.C==(BA(),zA)?"addon_sheets_promo":this.C==(BA(),AA)?"addon_slides_promo":"addon_docs_promo",d=this.qa();this.Dc(oz(VGf,{title:a,description:b,iconName:c},void 0,d))};function N6(){}y(N6,by);va(N6);N6.prototype.Da=function(a){a=N6.xa.Da.call(this,a);sx(a,"menuitem");return a};N6.prototype.dc=m("goog-control");N6.prototype.Nn=function(a){a=N6.xa.Nn.call(this,a);a.push("menu-button","goog-inline-block");return a};function fHf(a,b,c,d,e){D.call(this);this.O=b;this.Ka=c;this.H=a;this.D={};this.Ba={};this.oa={};this.ea=[];this.V=[];this.J=d||null;this.L=e||null;this.C=new eHf;this.F=new eHf;this.Na=new en;this.Aa(this.Na);this.Ea=[]}y(fHf,D);fHf.prototype.Ma=function(){me(this.D);fHf.xa.Ma.call(this)};fHf.prototype.ls=function(a){return Nd(this.D,a)};
function gHf(a,b,c){c=c?[c]:Ld(a.D);for(var d=0;d<c.length;d++)for(var e=c[d].fc(),f=0;f<e.Uc();f++){var h=e.Rc(f);if(h instanceof hy&&h.getId()==b||h instanceof eB&&(h=gHf(a,b,h)))return h}return null}
function hHf(a,b,c,d,e){if(L(b,3)){var f=L(b,7)||!1,h=b.Lh(),k=L(b,10),l=new hy("");l.Ie(L(b,1)||String(Ea(l)));var q=[ov(h)];d&&b.getKey()&&(d+=b.getKey().toUpperCase(),d=D_a(l,(Xu(),ju),[d]),a.ea.push(d),q.push(d));l.setContent(q);b=new rEf(L(b,4),L(b,3),void 0,L(b,9)||void 0,void 0,b.Tr()||void 0);Vz(a.O,l,(Xu(),ju),null,Oj(b),tGf(3,e));l.Qa(f);a.L&&f&&k&&(e=h+(" ("+(k+")")),c.push(a.L.Vp(ju,[b],Oj(e),Oj(e))[0]));return l}if(!b.Lh())return new ly;if(0<A6(b).length){l=new my;f=A6(b);for(h=0;h<f.length;h++)l.Ha(hHf(a,
f[h],c,d,e),!0);a=new eB(b.Lh());a.Ie(L(b,1)||String(Ea(a)));a.Ef(l);return a}throw Error("Unsupported menu item type.");}fHf.prototype.La=function(a,b){return gd(a.getName(),b.getName())};function zGf(a,b,c,d,e){if(b.Y_()){var f=new z6,h=String(Ea(f));N(f,1,h);b.Ha(hHf(a,f,d),!0)}d=new hy("Help");d.Ie(String(Ea(d)));Vz(a.O,d,(Xu(),qQa),null,Oj(c),tGf(3,e));d.Qa(!0);b.Ha(d,!0)}function yGf(a,b,c){var d=new hy("");d.Ie(wGf(UEf(c)));Vz(a.O,d,(Xu(),rQa),LW,Oj(L(c,1)),tGf(3,c));d.Qa(!0);b.Ha(d,!0)}
function wGf(a){return"addon-menu-install-"+a.C+"-"+a.D}function vGf(a){a.J.O$((Xu(),gOa).getId())||OW(a.J,(Xu(),gOa).getId(),[a.F,null]);a.J.O$((Xu(),fOa).getId())||OW(a.J,(Xu(),fOa).getId(),[a.C]);a.J.fc((Xu(),lu).getId(),!0)}function xGf(a,b,c){return 2==a.Ka?!1:b&&1==a.Ka?!!(c&&L(c,10)&&L(c,9)):!0}
function iHf(a,b,c){var d=c||ua;(c=a.C.F.get(b))?-1===a.Ea.indexOf(b)?(b=bn(x(function(a){a.dispatchEvent("load")},a,c),1E4),b=x(function(a,b,c){this.H.Oaa((Xu(),lu).getId());a.vg(!0);a.EF();cn(c);b()},a,c,d,b),a.Na.Lc(c,"load",b)):(a.H.Oaa((Xu(),lu).getId()),c.eD(),c.vg(!0),c.EF(),d()):d()};function jHf(a,b,c){b=c||b;c='<div class="'+W(a.Qz)+'" aria-labelledby="addon-sidebar-title" tabindex="0" role="region"><div class="'+W("addon-sidebar-header")+'"><div class="'+W("addon-sidebar-title")+'" id="addon-sidebar-title">';c+="Document add-ons";a=Bz(""+U($B({icon:a.zha},b)));c+="</div>"+U(TA({Ad:"addon-sidebar-close docs-material",content:a,style:4,title:Az(""+wz("Close sidebar"))},b))+'</div><div class="'+W("addon-sidebar-content")+'"><div class="'+W("addon-sidebar-banner")+'"></div><div class="'+
W("addon-sidebar-introduction")+'"></div></div><div class="'+W("addon-sidebar-empty-caption")+'"><div class="'+W("addon-sidebar-empty-title")+'">';c=c+"No document add-ons"+('</div><div class="'+W("addon-sidebar-empty-description")+'">');return V(c+"This document doesn't include any add-ons</div></div></div>")}function kHf(a){return V('<img class="'+W("addon-sidebar-banner-image")+'" src='+MY(Fz(a.L2a))+" alt="+MY(a.K2a)+' /><div class="'+W("addon-sidebar-banner-image-overlay")+'"></div>')};function lHf(a){var b=V,c='<div class="'+W("addon-sidebar-card")+'" aria-label="'+W(a.title)+'" tabindex="0" role="region"><div class="'+W("addon-sidebar-card-header")+'"><div class="'+W("addon-sidebar-card-icon")+'">'+(a.icon?'<img class="'+W("addon-sidebar-card-icon-image")+'" src='+MY(Fz(a.icon))+" alt="+MY(a.title)+" />":"")+'</div><div class="'+W("addon-sidebar-card-header-content")+'"><div class="'+W("addon-sidebar-card-title")+'"><div class="'+W("addon-sidebar-card-title-caption")+(a.D5b?" "+
W("addon-sidebar-card-two-line-title-caption"):"")+'">'+U(a.title)+"</div>";if(a.isInstalled){var d={n4a:Az("addon-sidebar-card-check"),color:"#455A64"};d=d||{};var e=d.n4a;d=d.color;e=V("<div"+(e?' class="'+W(e)+'"':"")+'><svg xmlns="http://www.w3.org/2000/svg" width="18px" height="18px" viewBox="0 0 48 48" fill="'+W(null!=d?d:"#000")+'"><path d="M0 0h48v48H0z" fill="none"/><path d="M24 4C12.95 4 4 12.95 4 24c0 11.04 8.95 20 20 20 11.04 0 20-8.96 20-20 0-11.05-8.96-20-20-20zm-4 30L10 24l2.83-2.83L20 28.34l15.17-15.17L38 16 20 34z"/></svg></div>');
e=U(e)}else e="";return b(c+e+'</div><div class="'+W("addon-sidebar-card-category")+'">'+U(a.category)+"</div></div></div>"+(a.summary?'<div class="'+W("addon-sidebar-card-summary")+'">'+U(a.summary)+"</div>":"")+"</div>")};function mHf(){}v(mHf,sO);mHf.prototype.dc=m("docs-material-menu-button-flat-primary");mHf.prototype.Tp=function(){return oz(f1b,{className:"docs-material-menu-button-flat-primary-dropdown"})};va(mHf);function nHf(a,b,c,d,e){c=void 0===c?mHf.getInstance():c;yy.call(this,a,b,c,d,e)}v(nHf,yy);function oHf(){}v(oHf,sO);oHf.prototype.dc=m("docs-material-menu-button-raised-primary");oHf.prototype.Tp=function(){return oz(f1b,{className:"docs-material-menu-button-raised-primary-dropdown"})};va(oHf);function pHf(a,b,c,d,e){c=void 0===c?oHf.getInstance():c;yy.call(this,a,b,c,d,e)}v(pHf,yy);function qHf(a,b,c,d,e){D.call(this);this.D=a;this.C=b;this.F=c;this.H=d;this.eb=e||av()}y(qHf,D);
function rHf(a,b){if(!b)return sHf(a);b=A6(b);if(1==b.length&&L(b[0],3)){var c=sHf(a);b=b[0];c.Qa(!!L(b,7));b=new rEf(L(b,4),L(b,3),void 0,L(b,9)||void 0);Vz(a.D,c,(Xu(),ju),{enabled:!0},Oj(b),a.F);return c}c=new my(a.eb);for(var d=0;d<b.length;d++)c.Ha(tHf(a,b[d]),!0);b=[ov("Use")];a=a.C?new pHf(b,c,void 0,a.eb):new nHf(b,c,void 0,a.eb);a.Uf("Use");a.Dd("addon-sidebar-card-menu-button");a.Qa(!0);return a}
function tHf(a,b){if(L(b,3)){var c=b.Lh(),d=new hy("");d.Dd(a.C?"addon-sidebar-menu-item-with-raised":"addon-sidebar-menu-item-with-flat");d.setContent([ov(c)]);c=new rEf(L(b,4),L(b,3),void 0,L(b,9)||void 0);Vz(a.D,d,(Xu(),ju),{enabled:!0},Oj(c),a.F);d.Qa(!!L(b,7));return d}if(!b.Lh())return new ly;if(0<A6(b).length){d=new my(a.eb);c=A6(b);for(var e=0;e<c.length;e++)d.Ha(tHf(a,c[e]),!0);b=new eB(b.Lh());b.Dd(a.C?"addon-sidebar-menu-item-with-raised":"addon-sidebar-menu-item-with-flat");b.Ef(d);return b}throw Error("Unsupported menu item type.");
}function sHf(a){var b=[ov("Use")];a=a.C?new uZ(b,a.eb):new FT(b,a.eb);a.Uf("Use");a.Dd("addon-sidebar-card-button");a.Qa(!1);return a};function O6(a,b,c,d,e){R.call(this,e);this.D=a;this.V=b;this.H=!(!L(this.D,10)&&!L(this.D,9));this.L=new Tz(void 0,void 0,!0,sC.getInstance());this.Aa(this.L);this.O=tGf(10,this.D);this.J=new Ox(void 0,void 0,e);this.Aa(this.J);this.F=new qHf(this.L,c,this.O,d,e);this.Aa(this.F);if(this.H)a=rHf(this.F);else{a=this.F;b=this.D;a:switch(a.H){case BA(),yA:c="Add to Docs";break a;case BA(),AA:c="Add to Slides";break a;case BA(),zA:c="Add to Sheets";break a;default:throw Error("Unsupported document type");
}d=[ov(c)];d=a.C?new uZ(d,a.eb):new FT(d,a.eb);d.Uf(c);d.Dd("addon-sidebar-card-button");d.Qa(!1);Vz(a.D,d,(Xu(),rQa),{enabled:!0},Oj(L(b,1)),a.F);a=d}this.C=a}y(O6,R);O6.prototype.Da=function(){O6.xa.Da.call(this);var a=L(this.D,15)||"";a&&(a=Hk(new Gk(a),"https").toString());var b=this.qa();a={icon:a,title:this.D.getName(),category:this.D.Wh(),isInstalled:this.H,summary:L(this.D,14),D5b:C.Fd};b=oz(lHf,a,void 0,b);this.Fb(b);this.Dc(b)};
O6.prototype.Dc=function(a){O6.xa.Dc.call(this,a);a=this.Ja("addon-sidebar-card-title-caption");sx(a,"button");this.Ha(this.J);this.J.Xa(a)};O6.prototype.Ia=function(){O6.xa.Ia.call(this);Vz(this.L,this.J,(Xu(),ou),{},Oj(UEf(this.D)),this.O);uHf(this)};O6.prototype.Ma=function(){E(this.C);O6.xa.Ma.call(this)};function vHf(a,b){a.H&&(a.C.getParent()==a&&a.removeChild(a.C,!0),E(a.C),a.C=rHf(a.F,b),a.Qb()&&uHf(a))}
function uHf(a){a.Ha(a.C,!0);a.H||(a.C.Qa(a.V),a.V||a.C.Td("Disabled for your organization"))};function wHf(a,b,c){qC.call(this,c);this.F={};this.D=[];this.Ea=!1;this.J=a;this.La=b;this.ea={};this.H=new qP(this.qa(),"addon-sidebar-spinner");this.Ha(this.H);this.C=new UA(void 0,this.qa());this.oa=this.Ba=!1}y(wHf,qC);n=wHf.prototype;n.Da=function(){wHf.xa.Da.call(this);var a={Qz:"addon-sidebar",zha:Wv("close-white")};a=oz(jHf,a,void 0,this.qa());this.Fb(a);this.Dc(a)};n.Dc=function(a){wHf.xa.Dc.call(this,a);this.H.render(this.Nb());a=this.H.Pa();wx(a,"Loading");sx(a,"status");tx(a,"live","polite")};
n.Ia=function(){wHf.xa.Ia.call(this);xHf(this,!1);yHf(this,!1);this.C.Xa(this.Ja("addon-sidebar-close"));this.getHandler().zg(this.C.Pa(),Dm,x(this.XNa,this)).R(this.getElement(),"keyup",this.ECb);this.Ba&&BGf(this)};n.Nb=function(){return this.zb("addon-sidebar-content")};function eGf(a,b){a.Qb()&&b in a.F&&(a=a.F[b],a.C.setContent("Adding..."),a.C.Qa(!1))}
function BGf(a){a.H.setVisible(!1);yHf(a,a.J);xHf(a,0==a.D.length);zHf(a,a.oa);AHf(a);yc(a.D,function(a){var b=L(a,2);a=new O6(a,this.Ea,this.oa,this.La,this.qa());vHf(a,this.ea[b]);this.Ha(a,!0);this.F[b]=a},a)}function AHf(a){Gd(a.F,function(a){this.removeChild(a,!0);E(a)},a);Rd(a.F)}function xHf(a,b){if(a.Qb()){var c=a.Ja("addon-sidebar-empty-caption");Q(c,b)}b&&yHf(a,!1)}
function yHf(a,b){if(a.Qb()){var c=a.Ja("addon-sidebar-introduction");b&&!Ev(c)&&Cv(c,1<a.D.length?"This template is optimized to work with these add-ons":"This template is optimized to work with this add-on");Q(c,b)}}function AGf(a){return 0==a.D.length?null:(a=L(a.D[0],16)||L(a.D[0],17))?Hk(new Gk(a),"https").toString():null}
function zHf(a,b){if(a.Qb()){Gx(a.getElement(),"addon-sidebar-with-banner",b);var c=a.Ja("addon-sidebar-banner");b?(b=AGf(a))&&mz(c,kHf,{L2a:b,K2a:a.D[0].getName()}):rv(c)}}n.Scb=function(a,b){return gd(a.getName(),b.getName())};n.ECb=function(a){27==a.keyCode&&(this.getElement()==a.target&&this.XNa(),a.stopPropagation())};n.XNa=function(){this.setVisible(!1);yHf(this,!1);this.J=!1;(Xu(),fu).Ub()};n.Qg=Pj;function BHf(a,b){WU.call(this,a,b)}y(BHf,WU);BHf.prototype.Xr=function(){return Xu(),qu};BHf.prototype.Vg=function(){return Xu(),pu};BHf.prototype.Kx=function(a){var b=this.C;b.Qb()||b.render();BHf.xa.Kx.call(this,a)};BHf.prototype.nUa=function(a){a&&this.Vg().isVisible()&&this.Kx(!0)};function P6(a,b,c){this.D=a;this.F=b;this.C=c;Object.defineProperties(this,{path:{get:x(this.Pfb,this),set:x(this.n1b,this)},invoke:{get:x(this.rfb,this),set:x(this.j1b,this)},arity:{get:x(this.geb,this),set:x(this.S0b,this)}})}n=P6.prototype;n.Pfb=g("D");n.n1b=fa("D");n.rfb=g("F");n.j1b=fa("F");n.geb=g("C");n.S0b=fa("C");function CHf(a,b,c,d,e){R.call(this,e);this.L=a;this.D=b;this.J=c;this.C=d}y(CHf,R);
CHf.prototype.Da=function(){var a=tc(A(),"docs-tfh"),b=this.L;if(a){var c={};c.allow_parent=a;b=GBd(b,c)}a=i0a(this.qa());ro(a,b);a.width="100%";a.height="100%";a.marginWidth="0";a.marginHeight="0";a.scrolling="no";a.allow="accelerometer ambient-light-sensor autoplay camera encrypted-media fullscreen geolocation gyroscope magnetometer microphone midi payment picture-in-picture speaker usb vr".split(" ").map(function(a){return a+" *;"}).join(" ");this.Fb(a);ra("payload",this.D,a);ra("adapter.hostFunctions",
this.J,a);Caa("adapter.getSessionId",x(this.H,this),a);Caa("adapter.getState",x(this.F,this),a)};CHf.prototype.Qg=Pj;CHf.prototype.H=function(){var a=this.C().C;return null===a?null:String(a)};CHf.prototype.F=function(){return this.C().getState()};function DHf(a,b,c,d,e,f,h,k,l){OB.call(this,void 0,void 0,l);var q=x(this.setVisible,this,!1),t=x(this.J,this),u=x(this.F,this);e&&this.setTitle(e);this.Pg=f||500;this.Ke=h||300;this.C=new CHf(a,b,[new P6("google.script.host.close",q,0),new P6("google.script.host.closeDialog",q,0),new P6("google.script.host.editor.focus",x(d.Sb,d,3),0),new P6("google.script.host.setWidth",t,1),new P6("google.script.host.setHeight",u,1)],c,l);this.Ha(this.C);mA(this,!!k);qA(this,null)}y(DHf,OB);
DHf.prototype.J=function(a){!isFinite(a)||0>a||Yw(this.Nb(),Math.min(a,Math.floor(.8*iv().width)))};DHf.prototype.F=function(a){!isFinite(a)||0>a||Zw(this.Nb(),Math.min(a,Math.floor(.8*iv().height)))};DHf.prototype.Da=function(){DHf.xa.Da.call(this);T(this.getElement(),"script-app-dialog");var a=this.Nb();T(a,"script-app-contents");Yw(a,Math.min(this.Pg,Math.floor(.8*iv().width)));Zw(a,Math.min(this.Ke,Math.floor(.8*iv().height)));this.C.render(a)};DHf.prototype.Qg=Pj;function EHf(a){qC.call(this,a);this.C=this.F=this.D=this.H=null}y(EHf,qC);n=EHf.prototype;n.x6=function(){this.C&&(this.removeChild(this.C,!0),this.C.dispose(),this.C=null);this.setVisible(!1)};n.focus=function(){this.C.getElement().focus()};n.Nb=g("F");
n.Da=function(){var a=this.qa(),b={id:this.getId(),Qz:"script-application-sidebar",YFb:"script-application-sidebar-header",T3:"script-application-sidebar-title",C4a:"script-application-sidebar-close",fL:"script-application-sidebar-content",zha:Wv("close-white")};b=oz(SGf,b,void 0,a);this.Fb(b);this.H=a.zb("script-application-sidebar-title",b);this.D=a.zb("script-application-sidebar-close",b);this.F=a.zb("script-application-sidebar-content",b)};
n.Ia=function(){EHf.xa.Ia.call(this);this.getHandler().zg(this.D,Dm,x(this.x6,this))};n.Qg=Pj;n.Ma=function(){delete this.H;delete this.D;delete this.F;delete this.C;EHf.xa.Ma.call(this)};function FHf(a,b){WU.call(this,a,b)}y(FHf,WU);FHf.prototype.Xr=function(){return Xu(),uQa};FHf.prototype.Vg=function(){return Xu(),vQa};function GHf(a,b,c,d,e){OB.call(this,void 0,!0,c);this.J=a;this.F=d||ua;gA(this,b);this.setVisible(!0);this.Zi=!0;pA(this,!1);qA(this,sA(sA(new nA,y0a,!0),vA,!1,!0));this.setTitle(e||"Authorization Required");xA(this,y0a.key)}y(GHf,OB);GHf.prototype.Ia=function(){GHf.xa.Ia.call(this);this.addEventListener("dialogselect",this.C)};GHf.prototype.Id=function(){GHf.xa.Id.call(this);this.removeEventListener("dialogselect",this.C)};
GHf.prototype.C=function(a){"cancel"!=a.key?DFf(this.J,this.F,null):this.F();this.setVisible(!1)};function HHf(a){OB.call(this,void 0,void 0,void 0);this.F=a;this.C=null;this.Zi=!0;this.setTitle("Message details");qA(this,z0a())}y(HHf,OB);HHf.prototype.Da=function(){HHf.xa.Da.call(this);var a=this.Nb();T(a,"script-error-dialog-content");this.C=ov(this.F);a.appendChild(this.C)};HHf.prototype.Ma=function(){HHf.xa.Ma.call(this);this.C&&tv(this.C)};function IHf(a){D.call(this);this.C=a}y(IHf,D);function fGf(a,b){b=FA(b,"warning",!0);a.C.postMessage(b);b.getId()}function JHf(a,b){var c=ld("Running script ");c=lv("SPAN",null,c);b=b?GA(c,"Cancel",b,"info",!0):FA(c,"info",!0);a.C.postMessage(b);return b.getId()}function kGf(a,b){a.C.postMessage(FA(b,"info",!1,2500))}
function KHf(a,b,c){var d=c?c:"Script "+(od(b)+" experienced an error");b=lv("SPAN","script-error-message",d);b.style.maxWidth="600px";c=x(function(){(new HHf(d)).setVisible(!0)},a);a.C.postMessage(GA([b],"Details",c,"warning",!0))}IHf.prototype.Ma=function(){delete this.C};function LHf(){D.call(this);this.C=null;this.D=new en;this.Aa(this.D)}y(LHf,D);LHf.prototype.Ma=function(){MHf();NHf(this);LHf.xa.Ma.call(this)};function NHf(a){a.D.Hc();a.C&&(a.C.dispose(),a.C=null);MHf()}function MHf(){var a=dv("docs-script-button-bar");a&&rv(a)};var OHf=new sJ(["http","https"]);function PHf(a){a=vd(a);if(jd(a)||qd(a,'"'))return null;var b=sk(1,a);return b?OHf.contains(b.toLowerCase())?a:null:null};function oGf(a,b,c,d,e,f){OB.call(this);this.ea=jd(vd(b))?"You can find "+(a+" in the Add-ons menu."):b;this.oa=c;this.Ba=d;this.C=PHf(e);this.V=PHf(f);this.O=ox(this,QHf);this.F=VA("Learn more");this.Ha(this.F);this.J=new UA("Report an issue");this.Ha(this.J);this.L=new UA("View in store");this.Ha(this.L);this.setTitle(ld("Help for "+a));a=new nA;sA(a,{key:vA.key,caption:"Close"},!1,!0);qA(this,a);xA(this,"ok")}y(oGf,OB);var QHf={G4:"script-help-dialog-buttonbar"};n=oGf.prototype;
n.Da=function(){oGf.xa.Da.call(this);var a=this.Nb();mz(a,XGf,{description:this.ea,Gf:this.O});T(a,"script-help-dialog")};n.Ia=function(){oGf.xa.Ia.call(this);var a=this.qa().getElement(this.O.G4);this.C&&(this.F.render(a),this.getHandler().R(this.F,"action",this.q7a));this.J.render(a);this.getHandler().R(this.J,"action",this.Mzb);this.L.render(a);this.getHandler().R(this.L,"action",this.XEb)};n.q7a=function(){this.C&&HA(this.C)};n.Mzb=function(){this.V?HA(this.V):(this.oa(),this.dispose())};
n.XEb=function(){this.Ba();this.dispose()};function pGf(a){vm.call(this,"ri");this.Nja=a}y(pGf,vm);function RHf(a,b,c,d){vm.call(this,"qi");this.W_b=a;this.fHb=b;this.title=d}y(RHf,vm);function qGf(a,b,c,d){R.call(this,d);this.H=a;this.F=b;this.J=PHf(c);this.D=ox(this,SHf);this.C=new Hz(d);this.Ha(this.C);rz(this.C.D,!1);this.C.zE=!0;this.C.setPosition(1)}y(qGf,R);var SHf={sK:"script-postinstallbubble-title",bX:"script-postinstallbubble-description"};n=qGf.prototype;
n.Da=function(){qGf.xa.Da.call(this);var a=this.qa(),b=this.getElement(),c=this.qa().getElement((Xu(),lu).getId()),d=jd(vd(this.F))?"Find your new add-on in this menu.":this.F;this.C.Dd("script-postinstallbubble-dialog");this.C.bk(c);this.C.render(b);b=this.C.getElement();Dv(b,!0);sx(b,"dialog");tx(b,"labelledby",this.D.sK);tx(b,"describedby",this.D.bX);this.C.setContent(oz(YGf,{title:this.H,description:d,Gf:this.D,EB:this.J},void 0,a))};
n.Ia=function(){qGf.xa.Ia.call(this);var a=this.qa().getElement((Xu(),lu).getId());this.getHandler().R(a,"mousedown",this.r7a)};n.setVisible=function(a){if(this.Qb()){var b=this.getElement();Q(b,a);this.C.setVisible(a);this.C.fd();bn(this.e1b,300,this)}};n.setTitle=fa("H");n.r7a=function(){this.dispose()};n.e1b=function(){try{C.Hb&&this.qa().Yb().body.focus(),this.C.getElement().focus()}catch(a){}};function THf(a,b,c,d,e,f){OB.call(this,void 0,void 0,f);this.L=b;this.F=d;this.J=e;this.C=null;this.setTitle(a);mA(this,!0);a=new nA(f);for(b=0;b<c.length;++b)d=c[b],a.set(d,UHf[d]);a.$M="0";qA(this,a)}y(THf,OB);var UHf={1:"Ok",4:"Cancel",2:"Yes",3:"No"};n=THf.prototype;
n.Da=function(){THf.xa.Da.call(this);var a=this.qa(),b=this.Nb();T(b,"script-prompt-contents");for(var c=a.Da("DIV"),d=this.L.split("\n"),e=0;e<d.length;++e)0<e&&c.appendChild(a.Da("BR")),c.appendChild(Mv(a,d[e]));b.appendChild(c);this.F&&(this.C=a.Da("INPUT"),b.appendChild(this.C))};n.Qg=Pj;n.Ia=function(){THf.xa.Ia.call(this);this.getHandler().R(this,"dialogselect",x(this.xLb,this))};n.focus=function(){THf.xa.focus.call(this);this.C&&this.C.focus()};
n.xLb=function(a){this.J(Number(a.key),this.F?this.C.value:null)};function VHf(a,b){OB.call(this);this.J=a;this.F=b;qA(this,sA(sA(new nA,{key:"send",caption:"Send"},!0),{key:"cancel",caption:"Cancel"},!1,!0));this.setTitle("Report an issue");this.C=new XS;this.Ha(this.C)}y(VHf,OB);n=VHf.prototype;n.Da=function(){VHf.xa.Da.call(this);xA(this,"send");var a=this.qa(),b=this.Nb();T(b,"script-reportissue-dialog-content");mz(b,ZGf,{Nja:this.F});a.appendChild(jA(this),a.Da("SPAN",{"class":"script-errormsg"}))};
n.Ia=function(){VHf.xa.Ia.call(this);this.C.Xa(this.Ja("script-reportissue-dialog-nonanonymous-checkbox"));var a=this.getHandler();a.R(this.Ja("script-reportissue-dialog-description"),"input",this.o_b);a.R(this,"dialogselect",this.s7a)};n.Rf=function(){return WHf(this).value};function WHf(a){return a.Ja("script-reportissue-dialog-description")}n.o_b=function(){var a=this.qa();Ex(WHf(this),"script-errorfield");a.Ge(this.Ja("script-errormsg"),"")};
n.s7a=function(a){if("send"!=a.key)return!0;a=this.qa();if(jd(this.Rf()))return T(WHf(this),"script-errorfield"),a.Ge(this.Ja("script-errormsg"),"Enter a description."),!1;this.J(this.Rf(),this.C.isChecked());return!0};function XHf(a,b){RY.call(this,b);this.C=a;this.oa=this.C.C.ppu;this.Ra=this.C.C.lpu;this.L=[]}var YHf,ZHf;y(XHf,RY);n=XHf.prototype;n.YWb=5;n.KF=4;n.Mla=0;n.DW=!1;n.G8=!1;n.ySa=null;function $Hf(a){return"googlexpc_"+a.C.name+"_msg"}function aIf(a){return"googlexpc_"+a.C.name+"_ack"}function bIf(a){try{if(!a.isDisposed()&&b3d(a.C))return a.C.Mu.frames||{}}catch(b){}return{}}function cIf(a,b){return bIf(a)[b]}
n.connect=function(){if(!this.isDisposed()&&b3d(this.C)){if(!this.G8){var a=$Hf(this);this.F=dIf(this,a);this.ea=SY(this).frames[a];a=aIf(this);this.D=dIf(this,a);this.O=SY(this).frames[a];this.G8=!0}if(eIf(this,$Hf(this))&&eIf(this,aIf(this)))this.Ka=new fIf(this,cIf(this,$Hf(this)),x(this.vXb,this)),this.Ba=new fIf(this,cIf(this,aIf(this)),x(this.uXb,this)),this.lza();else{if(1==TY(this.C))this.ySa||0<this.YWb--||(I2d(this.C,D2d(10)),gIf(this),this.G8=!1,this.ySa=dIf(this,"googlexpc_reconnect_"+
this.C.name));else if(0==TY(this.C)){a=bIf(this);for(var b=a.length,c=0;c<b;c++){try{if(a[c]&&a[c].name)var d=a[c].name}catch(f){}if(d){var e=d.split("_");if(3==e.length&&"googlexpc"==e[0]&&"reconnect"==e[1]){this.C.name=e[2];gIf(this);this.G8=!1;break}}}}SY(this).setTimeout(x(this.connect,this),100)}}};
function dIf(a,b){var c=nv("IFRAME"),d=c.style;d.position="absolute";d.top="-10px";d.left="10px";d.width="1px";d.height="1px";c.id=c.name=b;c.src=a.oa+"#INITIAL";SY(a).document.body.appendChild(c);return c}function gIf(a){a.F&&(a.F.parentNode.removeChild(a.F),a.F=null,a.ea=null);a.D&&(a.D.parentNode.removeChild(a.D),a.D=null,a.O=null)}function eIf(a,b){try{var c=cIf(a,b);if(!c||0!=c.location.href.indexOf(a.Ra))return!1}catch(d){return!1}return!0}
n.lza=function(){var a=bIf(this);a[aIf(this)]&&a[$Hf(this)]?(this.La=new hIf(this.oa,this.ea),this.J=new hIf(this.oa,this.O),SY(this).setTimeout(x(function(){this.La.send("SETUP");this.DW=!0},this),100)):(this.Ea||(this.Ea=x(this.lza,this)),SY(this).setTimeout(this.Ea,100))};function iIf(a){if(a.Oa&&a.Sa&&(UY(a.C),a.H)){for(var b=0,c;b<a.H.length;b++)c=a.H[b],a.C.eA(c.VV,c.Io);delete a.H}}
n.vXb=function(a){if("SETUP"==a)this.J&&(this.J.send("SETUP_ACK"),this.Oa=!0,iIf(this));else if(this.C.Uq()||this.Oa){var b=a.indexOf("|"),c=a.substring(0,b);a=a.substring(b+1);b=c.indexOf(",");if(-1==b)this.J.send("ACK:"+c),jIf(this,a);else{var d=c.substring(0,b);this.J.send("ACK:"+d);c=c.substring(b+1).split("/");b=parseInt(c[0],10);c=parseInt(c[1],10);1==b&&(this.V=[]);this.V.push(a);b==c&&(jIf(this,this.V.join("")),delete this.V)}}};
n.uXb=function(a){"SETUP_ACK"==a?(this.DW=!1,this.Sa=!0,iIf(this)):this.C.Uq()&&this.DW&&parseInt(a.split(":")[1],10)==this.Mla&&(this.DW=!1,kIf(this))};function kIf(a){if(!a.DW&&a.L.length){var b=a.L.shift();++a.Mla;a.La.send(a.Mla+b);a.DW=!0}}function jIf(a,b){var c=b.indexOf(":"),d=b.substr(0,c);b=b.substring(c+1);a.C.Uq()?a.C.eA(d,b):(a.H||(a.H=[])).push({VV:d,Io:b})}
n.send=function(a,b){a=a+":"+b;if(!C.Hb||3800>=b.length)this.L.push("|"+a);else{b=b.length;for(var c=Math.ceil(b/3800),d=0,e=1;d<b;)this.L.push(","+e+"/"+c+"|"+a.substr(d,3800)),e++,d+=3800}kIf(this)};n.Ma=function(){XHf.xa.Ma.call(this);Pc(lIf,this.Ka);Pc(lIf,this.Ba);this.Ka=this.Ba=null;tv(this.F);tv(this.D);this.ea=this.O=this.F=this.D=null};
var lIf=[],mIf=x(function(){var a,b=!1;try{for(var c=0;a=lIf[c];c++)b=b||a.vsa()}catch(d){if(a.H.C.close(),!lIf.length)return}a=Ga();b&&(YHf=a);ZHf=window.setTimeout(mIf,1E3>a-YHf?10:100)},XHf);function nIf(){YHf=Ga();ZHf&&window.clearTimeout(ZHf);ZHf=window.setTimeout(mIf,10)}function hIf(a,b){if(!/^https?:\/\//.test(a))throw Error("URL "+a+" is invalid");this.F=a;this.D=b;this.C=0}
hIf.prototype.send=function(a){this.C=++this.C%2;a=this.F+"#"+this.C+encodeURIComponent(a);try{C.Fd?uo(this.D.location,a):this.D.location.replace(a)}catch(b){}nIf()};function fIf(a,b,c){this.H=a;this.D=b;this.F=c;this.C=this.D.location.href.split("#")[0]+"#INITIAL";lIf.push(this);nIf()}fIf.prototype.vsa=function(){var a=this.D.location.href;if(a!=this.C){this.C=a;if(a=a.split("#")[1])a=a.substr(1),this.F(decodeURIComponent(a));return!0}return!1};function Q6(a,b){D.call(this);this.D={};this.F={};this.J=0;this.L=b;this.C=a;a=x(this.O,this);this.C.D=a}y(Q6,D);Q6.prototype.connect=function(a){this.C.connect(a)};function oIf(a,b){var c={role:0,ph:b,cn:"ide.api.ch"};C.Hb?(c.pu=b,c.tp=XHf):c.tp=1;b=new VY(c);b.Mu=a;return b}Q6.prototype.ea=function(a,b){za(b);var c=pIf(this,b[0]),d=pIf(this,b[1]);b=Vc(b,2);try{var e=a.apply(this,b);Da(e)?e(c,d):c.call(this,e)}catch(f){d.call(this,null)}};
Q6.prototype.O=function(a,b){if(dd(a,"callback.")&&Nd(this.D,a)){var c=Ud(this.D,a);b=null!=b?JSON.parse(b):null;var d=this.F[a];d&&(Sd(this.D,d),Sd(this.F,a),Sd(this.F,d));Sd(this.D,a);c.call(this,b)}};function pIf(a,b){return x(function(a){a=null!=a?Uk(a):null;this.C.send(b,a)},a)}Q6.prototype.Ma=function(){Q6.xa.Ma.call(this);delete this.L;delete this.D;delete this.F;delete this.J;delete this.C};function qIf(a,b,c,d){Q6.call(this,oIf(b,c),d||5E3);this.H=a;a=x(this.V,this);PY(this.C,"method.getContainerInfo",x(this.ea,this,a),!0)}y(qIf,Q6);qIf.prototype.V=function(){var a=this.H.call();return{sid:a.C,state:a.getState()}};qIf.prototype.Ma=function(){var a=this.C;qIf.xa.Ma.call(this);a.dispose();delete this.H};function rIf(a,b,c,d,e){D.call(this);this.H=a;this.L=b;this.V=c;this.F=d||null;this.J=e||null;this.C=this.D=null}y(rIf,D);rIf.prototype.open=function(){if(this.F){if(this.F.closed){this.F=null;return}this.D=this.F;this.F=null;uo(this.D.location,this.H)}else this.D=HA(this.H,{target:this.L});if(this.J)try{this.C=new qIf(this.J,this.D,this.V),this.C.connect(),bn(x(this.O,this,!0),1E5)}catch(a){this.C=null}};
rIf.prototype.O=function(a){try{!this.C||a&&this.C.C.Uq()||(this.C.dispose(),this.C=null)}catch(b){this.C=null}};rIf.prototype.close=function(){this.O();this.D&&!this.D.closed&&(this.D.close(),this.D=null)};rIf.prototype.Ma=function(){rIf.xa.Ma.call(this);this.C&&this.C.dispose();delete this.F;delete this.D;delete this.C;delete this.H;delete this.L};function sIf(a,b,c,d,e,f,h,k,l){P.call(this);this.V=[];this.La=!!k;this.F=a;this.O=b;this.Aa(this.O);this.oa=new LHf;this.Aa(this.oa);this.C=new IHf(DA.getInstance());this.Aa(this.C);this.D=null;this.Ea=new FHf(new EHf,l);this.ea=null;e&&(this.ea=new BHf(new wHf(f,h),l));this.H=new M6(void 0,k);this.H.Vd(this);this.Aa(this.H);this.F.oi(this.H);this.Ba=c;this.Ka=d;this.L=this.J=null}y(sIf,P);function dGf(a){return a.ea?a.ea.C:null}n=sIf.prototype;n.kc=g("La");
function tIf(a,b){if(null==b)a.H.reset(0);else{var c=a.H;c.reset(2);for(var d=0;d<b.length;d++)for(var e=b[d],f=th(e,lEf,4),h=0;h<f.length;h++){var k=f[h];k=new L6(e.getId(),e.getName(),k.getName());c.Ha(k,!0)}0===c.Uc()&&c.reset(1);a.H.isVisible()&&a.H.focus()}}function lGf(a,b,c,d){new GHf(a,(new MC).format(b),void 0,c,d)}function uIf(a,b){var c=dv("docs-script-button-bar");c&&(rv(c),jd(vd(a))||(a=new UA(a),a.Dd("docs-titlebar-button"),a.render(c),Am(a,"action",b)))}
function nGf(a,b,c){a.L&&!a.L.isDisposed()&&(PB(a.F,a.L),a.L.dispose());a.L=new VHf(b,c);a.L.Zi=!0;a.F.oi(a.L);a.L.setVisible(!0)}
n.C2b=function(a,b,c){var d=this.F,e=c||null;c="<p>";var f="Thanks! Your feedback was sent to the creators of <strong>"+(U(a)+"</strong>.");c=c+f+"</p>";e&&(c+="<p>",b?(a="You might not receive an individual reply, but if you'd like to learn more, check out "+('<a href="'+W(Ez(e))+'" target="_blank">'+(U(a)+" help</a>.")),c+=a):(a="You won't receive an individual reply, but if you'd like to learn more, check out "+('<a href="'+W(Ez(e))+'" target="_blank">'+(U(a)+" help</a>.")),c+=a),c+="</p>");c=
V(c);t0d(d,"Report an issue",jz(c),void 0,void 0,"Close")};n.B2b=function(){t0d(this.F,"Report an issue","We're sorry, but we encountered an error sending your issue report. Please try again later.",void 0,void 0,"Close")};function K6(a){a.dispatchEvent("ti")&&(a=a.Ka,a.C.isVisible()&&a.C.Kf(),a.D.Qb()||a.D.render(a.F||void 0),a.D.show())}n.nE=function(){this.dispatchEvent("pi")&&this.Ka.D.Kf()};n.pWb=function(a,b,c,d,e){a=new rIf(a,"MacroService"+Ad(c),b,e,d);this.V.push(a);a.open()};n.OQa=function(a){HA(a)};
n.Ma=function(){sIf.xa.Ma.call(this);me(this.V)};function vIf(a,b,c,d,e,f,h,k,l,q,t,u,w,z,J,S,ca,ba,ea){D.call(this);this.J=a;this.O=l;this.Sa=k;this.oa=q;this.H=b;this.ea=c;this.L=d;this.D=S;this.Na=new en(this);this.Aa(this.Na);this.Oa=t;this.Ra=z||Rj;this.V=new PGf(this.ea,this.L);this.Aa(this.V);this.Ka=ca||!1;a=this.oa;c=this.Ka;this.C=new sIf(e,h,t,u,wIf(a),c,a,w,J);this.Aa(this.C);this.La=new CFf;h=0;b.D?b.C&&(h=2):h=1;this.F=new bGf(this.oa,e,f,this.C,this.La,this.J,this.ea,this.O,h,this.D,ba,ea);this.Aa(this.F);this.Ba={};this.Ea=null}
y(vIf,D);n=vIf.prototype;
n.start=function(){if(sm(this.J.J,1,1)){this.Na.R(this.L,"amep",x(this.hLb,this));this.Na.R(this.L,"stbep",x(this.oLb,this));this.Na.R(this.L,"sttep",x(this.pLb,this));this.Na.R(this.L,"spep",x(this.nLb,this));this.Na.R(this.L,"saep",x(this.lLb,this));this.Na.R(this.L,"snep",x(this.mLb,this));this.Na.R(this.L,"paep",x(this.jLb,this));this.Na.R(this.L,"rfep",x(this.kLb,this));this.Na.R(this.C,"dialogselect",x(this.aqb,this));this.Na.R(QS.getInstance(),"ed",x(this.iLb,this));this.Sa(x(this.Wpb,this));
var a=this.J.C;(Xu(),ju).Vb(bs,this.Upb,this);oQa.Vb(bs,this.Zzb,this);hu.Vb(bs,x(a.Mr,a,x(this.pub,this)));iu.Vb(bs,this.Rma,this);ku.Vb(bs,x(this.kIa,this));ou.Vb(bs,x(this.oub,this));sQa.Vb(bs,x(this.kIa,this));pQa.Vb(bs,this.mob,this);qQa.Vb(bs,this.cqb,this);rQa.Vb(bs,this.dtb,this);wQa.Vb(bs,x(this.JB,this,"0"));xQa.Vb(bs,x(this.JB,this,"1"));yQa.Vb(bs,x(this.JB,this,"2"));zQa.Vb(bs,x(this.JB,this,"3"));AQa.Vb(bs,x(this.JB,this,"4"));BQa.Vb(bs,x(this.JB,this,"5"));CQa.Vb(bs,x(this.JB,this,"6"));
DQa.Vb(bs,x(this.JB,this,"7"));EQa.Vb(bs,x(this.JB,this,"8"));FQa.Vb(bs,x(this.JB,this,"9"));this.V.start();xIf(this.oa,this.Ka)&&(qu.Qa(!0),qu.Ub(void 0,tGf(19)));var b=!this.H.C;a=this.H.J;if(this.H.V){var c=this.H.oa;c&&iGf(this.F,new E6(c),!0);YFf(this.F,x(function(){ku.Qa(b);this.H.Ka&&b&&this.F.L();var a=this.H.Ba;if(a){var c=this.F,f=c.C.O;a=J6(c,new E6(a))||CGf(c,a);f&&a&&(K6(c.C),c=x(c.C.nE,c.C),iHf(f,L(a,2),c))}},this))}IFf(this.ea,this.O().getState()||void 0,b,a)}};
function yIf(a){tIf(a.C,null);var b=x(function(a){a.zm()?tIf(this.C,th(a,jEf,2)):(this.C.C.C.postMessage(FA("Could not load scripts.","warning",!0)),tIf(this.C,[]))},a);HFf(a.ea,b)}
function zIf(a,b,c,d,e,f){if(d){K6(a.C);var h=x(function(){var a=CGf(this.F,b);a&&!L(a,4)&&(N(a,4,!0),gGf(this.F))},a),k=x(function(){this.C.nE();this.J.dk.dispatchEvent(new nn(!0))},a),l=x(function(a){this.C.nE();8!=L(a,2)&&KHf(this.C.C,c,a.Xg())},a);mGf(a.F,b)}else{var q=JHf(a.C.C),t=x(function(a){this.V.D.cancel(a);EA(this.C.C.C,q)},a);h=x(function(a){EA(this.C.C.C,q);q=JHf(this.C.C,Fa(t,a))},a);k=x(function(a){EA(this.C.C.C,q);if(a.uka()){a=this.C.C;var b=ld("Canceled script ");a.C.postMessage(FA(b,
"info",!1,2500))}else a=this.C.C,b=ld("Finished script "),a.C.postMessage(FA(b,"info",!1,2500));this.J.dk.dispatchEvent(new nn(!0))},a);l=x(function(a){EA(this.C.C.C,q);8!=L(a,2)&&KHf(this.C.C,c,a.Xg())},a)}a.Oa.Sb(3);O0d(a.J.C,x(a.R_b,a,b,c,h,k,l,d,e,f))}n.R_b=function(a,b,c,d,e,f,h,k){var l=this.O().getState()||void 0,q=this.V;c=x(q.rLb,q,a,b,c||ua,d||ua,e||ua);q.D.HLa(a,b,l,c,f,h,k)};
n.iLb=function(a){var b=Sc(this.F.D),c={};b=ja(b);for(var d=b.next();!d.done;d=b.next())d=d.value,c["ADD-ON:"+L(d,2)]={name:d.getName(),"cws-id":L(d,1),"gsm-application-id":L(d,18),"app-key":L(d,2)};Xd(a.nF,c)};n.mob=function(a){a.data==this.Ea&&(a=this.C,a.dispatchEvent("oi")&&a.Ea.C.x6())};
n.hLb=function(a){a=a.C().fc();var b={},c=AIf(this,a),d=this.La,e=c,f=L(a,4),h=1==M(a,11,0);e=new H6(a,e,h);e.setVisible(!0);0==M(a,11,0)&&(f=e.getLabel());d.C[M(a,11,0)][f]=e;d.dispatchEvent("si");(d=dGf(this.C))&&L(a,9)&&(1==L(a,12)||5==L(a,12))&&(f=L(a,4),d.ea[f]=a,f&&f in d.F&&vHf(d.F[f],a));c=c.reverse();if(d=this.C.O){for(f=0;f<c.length;f++)if(e=c[f],h=e.getKey())if(b[h])N(e,5,void 0);else{if(this.Ba[h]){var k=d,l="Ctrl+Alt+Shift+"+h.toUpperCase();l=Rz((Xu(),ju),[l]);for(var q=0;q<k.ea.length;q++){var t=
k.ea[q];Ev(t)==l&&Cv(t,"")}}this.Ba[h]=L(e,1);b[h]=!0}if(1==M(a,11,0)){b=L(a,4);b=CGf(this.F,b);b=null!=b?b:null;c=[];f=L(a,4);h=!!L(a,9)&&3!=L(a,12);e=d.C.F.get(f);e||(e=new eB(""),e.Ie(f),k=L(a,10),e.setContent(ov(k)),e.Qa(xGf(d,h)),d.F.Hc(),uGf(d.C,e),vGf(d));h||d.V.push(f);h=new my;!b||L(b,10)||L(b,9)||(yGf(d,h,b),k=new z6,l=String(Ea(k)),N(k,1,l),h.Ha(hHf(d,k,c),!0));a=A6(a);for(k=0;k<a.length;++k)h.Ha(hHf(d,a[k],c,void 0,b?b:void 0),!0);b&&zGf(d,h,f,c,b);d.oa[f]=c;e.Ef(h);e.dispatchEvent("load");
d.Ea.push(f)}else{b=a.Lh();if(d.ls(b)){d.ls(b);c=d.D[b];delete d.D[b];d.H.removeChild(c,!0);if(d.L)for(f=d.Ba[b],e=0;e<f.length;++e)d.L.zL(f[e]);delete d.Ba[b];c.dispose()}10<=Kd(d.D)||(b=[],A6(a),c=a.Lh(),a=hHf(d,a,b,"Ctrl+Alt+Shift+").fc(),a=new cB(c,a,N6.getInstance(),void 0,!0),f=d.H.Uc()?d.H.Uc()-1:0,d.H.Mf(a,f,!0),d.D[c]=a,d.Ba[c]=b)}}};
n.oLb=function(a){a=a.C();var b=a.Lh();b?uIf(b,x(function(a){var b=vd(L(a,5));jd(b)||this.C.OQa(b);b=vd(a.getFunctionName());jd(b)||zIf(this,L(a,1),b,L(a,4)||void 0,void 0,a.Tr()||void 0)},this,a)):MHf()};
n.pLb=function(a){var b=a.C();a=b.getText();b=b.Sk();var c=this.C.oa,d=dv("docs-script-button-bar");d&&(NHf(c),jd(vd(a))||(a=oz(TGf,{caption:a}),qv(d,a),jd(vd(b))||(c.C=new Hz,c.C.Dd("docs-script-button-bar-bubble"),c.C.setContent(oz(UGf,{text:b})),c.C.bk(a),rz(c.C.D,!0),c.C.zE=!1,c.C.setPosition(1,1),c.C.Pz(!1),c.C.render(d),c.D.R(a,"mouseover",x(c.C.setVisible,c.C,!0)).R(a,"mouseout",x(c.C.setVisible,c.C,!1)))))};
n.nLb=function(a){this.C.nE();var b=a.C(),c=M(b,6,!1);a=c?L(b,3).replace(/\n/g," ").replace(/\\n/g,"\n"):L(b,3);var d=L(b,7),e=this.C,f=b.getTitle(),h=lh(b,4),k=M(b,5,!1);b=x(this.Gyb,this,L(b,1),c,d);e.D&&(e.D.setVisible(!1),PB(e.F,e.D));e.D=new THf(f,a,h,k,b);e.D.Zi=!0;e.F.oi(e.D);e.D.setVisible(!0)};n.Gyb=function(a,b,c,d,e){var f=new nEf;N(f,1,d);N(f,3,b);N(f,4,c);null!==e&&N(f,2,e);(Xu(),oQa).Ub([a,Uk(f.gg())])};
n.lLb=function(a){a=a.C();var b=this.H;var c=O(a,FDf,9);c=L(c,4)||"";c=Zya(c);var d={};d.mid=b.H;b=GBd(c,d);switch(M(a,6,0)){case 1:var e=this.C;c=L(a,3);d=this.O;var f=a.getTitle()||void 0;if(e.dispatchEvent(new RHf(b,c,d,f))){var h=e.Ba;e=e.Ea.C;e.Qb()||(e.render(),e.resize());e.x6();var k=e.qa();k.Ge(e.H,f||"Apps Script application");f=x(h.Sb,h,3);e.C=new CHf(b,c,[new P6("google.script.host.close",x(e.x6,e),0),new P6("google.script.host.editor.focus",f,0)],d,k);le(e.C,f);e.Ha(e.C,!0);(Xu(),uQa).Ub()}this.Ea=
L(a,7)||null;break;default:c=this.C,d=L(a,3),f=this.O,h=a.getTitle()||void 0,e=a.getWidth()||void 0,k=a.getHeight()||void 0,a=M(a,8,!1),c.D&&(c.D.setVisible(!1),PB(c.F,c.D)),c.D=new DHf(b,d,f,c.Ba,h,e,k,a),c.D.Zi=!0,c.F.oi(c.D),c.D.setVisible(!0)}};n.mLb=function(a){a=a.C();var b=a.getType();this.Ra(b,a.getText(),a.getTitle()||void 0,L(a,4)||void 0)};
n.jLb=function(a){a=a.C();var b=O(a,uEf,3);if(b&&L(b,2)){var c=L(b,2);b=new E6(c,L(b,11));L(a,4)?(b=J6(this.F,b),null!=b&&L(b,10)?(b="The add-on "+(b.getName()+" needs your permission to run in this document."),lGf(L(a,1),"",void 0,b)):lGf(L(a,1),"A script attached to this document needs your permission to run.",void 0,"Updated add-on")):this.F.L(b)}else lGf(L(a,1),"A script attached to this document needs your permission to run.")};
n.kLb=function(a){a=a.C();zIf(this,L(a,1),a.getFunctionName(),L(a,4)||void 0,void 0,a.Tr()||void 0)};n.Upb=function(a){a=a.data;var b=CGf(this.F,a.C);!b||L(b,9)?zIf(this,a.C,a.functionName,a.ZG||void 0,1,a.vG||void 0):this.F.L(new E6(L(b,1),L(b,18)))};n.Zzb=function(a){K6(this.C);var b=a.data;a=b[0];b=b[1];var c=x(function(){this.C.C.C.postMessage(FA("Error resuming script execution","warning",!0))},this);QGf(this.V,a,b,c)};n.pub=function(){this.C.H.setVisible(!0);yIf(this)};
n.Rma=function(a){var b=a.data;a=b?b.scriptId:void 0;a=new Gk(EGf(this.H,a?a:void 0));b&&(a=b.editorUri?new Gk(b.editorUri):a,b.filename&&a.rc("f",b.filename),b.lineNumber&&(a.rc("l",b.lineNumber),a.rc("s",b.lineNumber)));b=this.J.F;var c=null;jm(this.J.C)||(c=hwd({target:"MacroService"+Ad(b)}));this.J.C.Mr(x(this.C.pWb,this.C,a.toString(),this.H.O,b,this.O,c))};n.kIa=function(){this.F.L()};n.oub=function(a){a.data?this.F.L(a.data):this.F.L(void 0,void 0,void 0,void 0,!0)};
n.cqb=function(a){(a=CGf(this.F,a.data))&&XFf(this.F,UEf(a))};n.dtb=function(a){a.data&&iGf(this.F,new E6(a.data),!1)};n.aqb=function(a){"edit"==a.key?(a=a.target.lr.bf(),a=EGf(this.H,a?a.yMa:void 0),this.Rma(new uLa({editorUri:a}))):"new"==a.key?(a=this.H.ea,this.Rma(new uLa({editorUri:a}))):"reload"==a.key?yIf(this):"run"==a.key&&(a=a.target.lr.bf(),zIf(this,a.yMa,a.getFunctionName(),void 0,void 0,a.Tr()))};n.JB=function(a){(a=this.Ba[a])&&(a=gHf(this.C.O,a))&&a.isEnabled()&&a.dispatchEvent("action")};
n.Wpb=function(){for(var a=this.C,b=0;b<a.V.length;b++){var c=a.V[b];c.close();c.dispose()}a.V=[]};function AIf(a,b){var c=[];L(b,3)&&c.push(b);b=A6(b);for(var d=0;d<b.length;d++)c=c.concat(AIf(a,b[d]));return c}n.getView=g("C");function wIf(a){return a==(BA(),yA)||a==(BA(),AA)||a==(BA(),zA)}function xIf(a,b){return b&&(a==(BA(),yA)||a==(BA(),zA))};function BIf(a,b,c,d,e,f,h){D.call(this);var k=this;this.D=a;this.L=b;this.eb=e;this.F=d;this.ea=new hm;this.C=f;this.oa=h;this.V=new Sv(this);this.Aa(this.V);this.V.Vb(ggb,Yr,this.J);this.Na=new en(this);this.Aa(this.Na);lm(this.ea,this.F.F,function(){return k.J()});this.H=new aB(this.eb.Yb(),!0);this.Aa(this.H);this.O={};this.J()}v(BIf,D);BIf.prototype.J=function(){var a=CIf(this),b=this.L.fc(kgb.getId(),!0);b.Cd(!0);NGd(this.L,b,[new IId(a)]);T(b.getElement(),"waffle-action-menu")};
function CIf(a){var b=Array.from(a.F.D.values());DDf(b,function(a){return G(a,8)});var c=Array.from(a.F.C.values());nC(a.oa,YLc(0<b.length,0<c.length));jgb.setProperty("visible",!0);igb.setProperty("visible",!0);var d={};c={};b=ja(b);for(var e=b.next();!e.done;c={Pea:c.Pea},e=b.next()){e=e.value;var f=e.lk(),h=e.getFunctionName(),k=G(e,8),l=Ke(e,9)?G(e,9):null,q="recorded-action-"+f+":"+h,t=a.D.iA(q);t||(t=(new AVa(q)).enabled(!0),t.Fa(29583),t=t.build(),c.Pea=new rEf(f,h,void 0,void 0,void 0,e.Tr()||
void 0),t.Vb(bs,function(a){return function(){(Xu(),ju).Ub(a.Pea)}}(c)),YA(a.H,[t]),a.D.Gx(t),a.C&&a.C.Vh(t));t.setProperty("label",k);DIf(a,l)&&t.setProperty("keys",[l]);null==l&&null!=t.getProperty("keys")&&t.setProperty("keys",null);d[q]=t}Gd(a.O,function(b,c){d[c]||(b.setProperty("keys",null),a.D.GV(c),a.C&&a.C.zL(c),E(b))});a.O=d;return Ld(d)}function DIf(a,b){return!ggb.Bd()&&null!=b&&/^Ctrl\+Alt\+Shift\+\d$/i.test(b)&&0==(a.H.C[Hb(b)]||[]).length};function EIf(a,b){this.Rca=a;this.s3=b};function FIf(a,b,c){b=c||b;a='<div class="waffle-recording-toast" role="complementary" tabIndex="0" aria-describedby="waffle-recording-toast-content"><div class="waffle-recording-toast-top"><div class="waffle-recording-toast-icon"><div class="waffle-recording-toast-outer-circle"><div class="waffle-recording-toast-inner-circle"></div></div></div><div class="waffle-recording-toast-content"><div class="waffle-recording-toast-new-content"></div><div class="waffle-recording-toast-default-content">Recording new macro...</div></div><div class="waffle-recording-toast-right"><div class="waffle-recording-toast-cancel">Cancel</div><div class="waffle-recording-toast-stop">Save</div><div class="waffle-recording-toast-expand-section"><div class="waffle-recording-toast-expand"><div class="waffle-recording-toast-expand-icon"></div></div></div></div></div><div class="waffle-recording-toast-bottom" role="radiogroup"><div class="waffle-recording-toast-relativity-split"><div class="waffle-recording-toast-absolute">'+
U(NU({label:Bz('Use absolute references<div class="waffle-recording-toast-label-description">When applying macro use exact location as recorded</div>')},b));a=a+'</div></div><div class="waffle-recording-toast-relativity-split"><div class="waffle-recording-toast-relative">'+U(NU({label:Bz('Use relative references<div class="waffle-recording-toast-label-description">When applying macro use active selection</div>')},b));return V(a+"</div></div></div></div>")};function GIf(a){R.call(this,a);this.J=new dy("",new fC,this.qa());this.Ha(this.J);this.F=new dy("",new fC,this.qa());this.Ha(this.F);this.D=new Tz;this.Aa(this.D);this.H=null;this.C=0}v(GIf,R);n=GIf.prototype;n.Da=function(){this.Fb(oz(FIf))};
n.Ia=function(){R.prototype.Ia.call(this);this.O=new WY(this.qa(),void 0,"relative");this.L=new WY(this.qa(),void 0,"absolute");this.O.Xa(this.Ja("waffle-recording-toast-relative"));this.L.Xa(this.Ja("waffle-recording-toast-absolute"));var a=Vd(Wz);Td(a,"selected",!0);var b=Yx(new Xx,6).build();Vz(this.D,this.O,bF,a,void 0,b);Vz(this.D,this.L,cF,a,void 0,b);Vz(this.D,this.J,(Xu(),ru),void 0,void 0,b);Vz(this.D,this.F,aF,void 0,void 0,b);this.H=new yO(this.Ja("waffle-recording-toast-expand"),this.Ja("waffle-recording-toast-bottom"),
ngb.isVisible(),void 0,this.qa());this.Aa(this.H);this.getHandler().R(this.H,"toggle",this.qzb);this.J.Xa(this.Ja("waffle-recording-toast-stop"));this.F.Xa(this.Ja("waffle-recording-toast-cancel"))};n.setVisible=function(a){var b=this.Pa();Q(b,a);tx(b,"hidden",!a);a&&(a=this.qa().Yb(),a=kv(a)||window,b=$w(this.Pa()),this.Pa().style.left=Math.max(Math.floor(iv(a).width/2-b.width/2),0)+"px")};
function HIf(a,b){a.Ja("waffle-recording-toast-default-content").style.opacity=0;var c=a.Ja("waffle-recording-toast-new-content");a.qa().Ge(c,b);0!=a.C?IIf(a):(cn(a.C),a.C=bn(function(){return IIf(a)},400))}function IIf(a){var b=a.Ja("waffle-recording-toast-new-content");Ex(b,"waffle-recording-toast-slide-in");cn(a.C);a.C=bn(function(){T(b,"waffle-recording-toast-slide-in");cn(a.C);a.C=bn(function(){return JIf(a)},2200)})}
function JIf(a){var b=a.Ja("waffle-recording-toast-default-content"),c=a.Ja("waffle-recording-toast-new-content");Ex(c,"waffle-recording-toast-slide-in");b.style.opacity=1;cn(a.C);a.C=bn(function(){a.C=0},400)}n.qzb=function(a){ngb.setVisible(a.Xw)};n.Ma=function(){cn(this.C);R.prototype.Ma.call(this)};function KIf(a,b,c,d){D.call(this);var e=this;this.Ba=a;this.Ka=c;this.F=d;this.J=new yj;this.C=ritz_api.ScriptRecorder.createScriptRecorder(ritz_api.RitzModelApi.getTopLevelModel(),ritz_api.RitzModelApi.getRecordingMessages(),R6(this),bF.Bd(),function(a){a="Action "+(e.C.countRecordedRequests()+(": "+a));LIf(e,a)},ritz_api.RitzModelApi.getRitzSettings());ritz_api.RitzModelApi.setScriptRecorder(this.C);this.H=new GIf;this.Aa(this.H);this.Ea=new Sv(this);this.Aa(this.Ea);this.Ea.Vb(bF,bs,this.REb,
this).Vb(cF,bs,this.PEb,this).Vb((Xu(),YLa),bs,this.Cob,this).Vb(ju,bs,this.yAb,this).Vb(ccb,bs,function(){return ritz_api.ScriptRecorderActions.recordRefreshDbQueries(e.C,R6(e),!1)},this).Vb(bcb,bs,function(){return ritz_api.ScriptRecorderActions.recordRefreshDbQueries(e.C,R6(e),!0)},this).Vb(rD,bs,this.gnb,this).Vb(sD,bs,function(a){return ritz_api.ScriptRecorderActions.recordEditDbQuery(e.C,R6(e),e.J.serialize(a.data))},this);this.D=new hm;this.Aa(this.D);lm(this.D,a.Sa,function(){e.C.startRecordingAction(!0,
R6(e))});lm(this.D,a.Ra,function(a){if(a.D){var b=a.C.D();"docs-edit"==b?"ritz-waffle"==a.C.C()&&e.C.finishRecordingAction(R6(e)):"docs-undo"==b?(LIf(e,"Undo previous action"),e.C.undo()):"docs-redo"==b&&(LIf(e,"Redo previous action"),e.C.redo())}});lm(this.D,b.oa,function(a){a.C||ritz_api.ScriptRecorderActions.recordUpdateTitle(e.C,R6(e),a.dV)});lm(this.D,this.F.pb,function(a){return MIf(e,a)});lm(this.D,this.F.Xb,function(){e.V=R6(e)});lm(this.D,this.F.Rb,function(a){switch(a.D){case "find-next-occurrence":ritz_api.ScriptRecorderActions.recordFind(e.C,
e.V,R6(e),a.C);break;case "replace-current-occurrence":ritz_api.ScriptRecorderActions.recordReplace(e.C,R6(e),a.C)}e.V=null});lm(this.D,this.F.Sa.D,function(a){ritz_api.ScriptRecorderActions.recordUpdateProtectionAcls(e.C,R6(e),a.C,a.D,a.F,a.H,a.id)});lm(this.D,b.dk,function(){ritz_api.ScriptRecorderActions.recordCalledScript(e.C,e.oa,R6(e),e.ea);e.oa=null;e.ea=null});lm(this.D,this.F.gc,function(a){ritz_api.ScriptRecorderActions.recordCreateDbQuery(e.C,e.J.serialize(e.L.D.C),e.J.serialize(a.getSelection().C),
e.J.serialize(e.L.C));e.L=null});this.Na=new en(this);this.Aa(this.Na);this.L=this.V=this.ea=this.oa=this.O=null;this.Na.R(this.F.C,"Z",this.aQb).R(this.F.C,"ea",this.$Pb);this.H.render();this.H.setVisible(!0);NIf(this);setTimeout(function(){return PK("All actions are now being recorded. Please use the Tools menu to cancel or save recording.")})}v(KIf,D);n=KIf.prototype;n.$Pb=function(){this.O=R6(this)};
n.aQb=function(a){!a.bC&&VN(this.F)&&(na(a.pQ)?(a=a.pQ,ritz_api.ScriptRecorderActions.switchToAdjacentSheet(this.C,this.O,R6(this),a)):(a=this.F.C.C.xe(),HIf(this.H,"Activating sheet "+a),ritz_api.ScriptRecorderActions.switchToExplicitSheet(this.C,this.O,R6(this),a)),this.O=null)};function LIf(a,b){HIf(a.H,b);PK("Macro recorder "+b)}function OIf(a){return a.C.endScript(R6(a))}n.yAb=function(a){this.ea=a.data.functionName;this.oa=R6(this)};
function MIf(a,b){var c=R6(a);a.Na.Lc(a.F,"tb",function(){var d=R6(a);switch(b.H){case "adjust-next-data-region-edge":ritz_api.ScriptRecorderActions.recordAdjustSelectionToNextDataRegionEdge(a.C,c,d,b.D,b.C);break;case "move-next-data-region-edge":ritz_api.ScriptRecorderActions.recordMoveSelectionToNextDataRegionEdge(a.C,c,d,b.D,b.C);break;case "select-all":ritz_api.ScriptRecorderActions.recordSelectAll(a.C,c,d);break;case "select-rows-columns":ritz_api.ScriptRecorderActions.recordSelectRowsColumns(a.C,
c,d,"c"==b.F)}})}n.Cob=function(a){a=a.data;ritz_api.ScriptRecorderActions.recordMakeCopy(this.C,R6(this),a.C)};n.gnb=function(a){a=a.data;var b=this.Ba.C.getSelection();this.L=new PIf(a,b)};n.REb=function(){var a=!this.C.isRelative();this.C.setRelativity(!0);bF.jc(!0);cF.jc(!1);a&&(HIf(this.H,"Using relative references"),PK("Recording with relative references"))};n.PEb=function(){var a=this.C.isRelative();this.C.setRelativity(!1);bF.jc(!1);cF.jc(!0);a&&(HIf(this.H,"Using absolute references"),PK("Recording with absolute references"))};
function NIf(a){(a=ZK(a.Ka))&&AQ(a)}function R6(a){var b=a.Ba.C.getSelection();return a.J.serialize(b.C)}n.Ma=function(){ritz_api.RitzModelApi.clearScriptRecorder();D.prototype.Ma.call(this)};function PIf(a,b){this.C=a;this.D=b};function QIf(a,b,c,d){gC.call(this,"Macro saved",av(),!1,1E4,!0,void 0,!0,["waffle-recording-toast-saved"]);this.Va=a;this.Ea=b;this.L=c;this.Sa=d}v(QIf,gC);QIf.prototype.Da=function(){gC.prototype.Da.call(this);var a=nx(this,"script-recorder-edit-link-id");this.Qs("EDIT SCRIPT",a)};QIf.prototype.Ia=function(){gC.prototype.Ia.call(this);this.getHandler().zg(px(this,"script-recorder-edit-link-id"),Dm,x(this.J,this,this.Va,this.Ea,this.L))};
QIf.prototype.J=function(a,b,c){this.Sa.C(29645);(Xu(),iu).Ub(b?{scriptId:a,filename:b,lineNumber:c}:void 0)};function RIf(a,b,c,d,e,f,h,k,l,q,t){lC.call(this);var u=this;this.ea=a;this.O=b;this.Sa=c;this.Oa=d;this.L=e;this.F=f;this.Ka=h;this.V=k;this.J=t;this.oa=new Sv(this);this.Aa(this.oa);this.D=null;this.H=!1;this.C=null;this.Ra=l;this.oa.subscribe(lgb,"action",this.A1b).subscribe((Xu(),ru),"action",this.y3b).subscribe(ogb,"action",this.Z_b).subscribe(aF,"action",this.U3a).subscribe(igb,"action",this.b2b).subscribe(jgb,"action",this.j2b);mC(this,SIf(this));ow(this.F,this);a=["not-revisions","sheet-access-edit",
"netStatus-online"];var w=new nw(a.concat(["docs-script-recording"]));yc([aF,ru,ogb,mgb,cF,bF],function(a){u.F.C(a,w);u.F.F(a,w)});a=new nw(a.concat(["not-docs-script-recording"]));this.F.C(lgb,a);this.F.F(lgb,a)}v(RIf,lC);n=RIf.prototype;n.A1b=function(){var a=this;this.D=new KIf(this.Sa,this.Oa,this.L,this.Ka);nC(this,SIf(this));this.Ka.D.C.Mr(function(){cp(Fj(dp(a.ea.jf("/startrecordingscript"),"POST"),1).setTimeout(18E4)).$e()})};
n.y3b=function(){$K(this.L)&&eQ(ZK(this.L),!0);this.D.H.setVisible(!1);ritz_api.RitzModelApi.clearScriptRecorder();ADf(this.O)};
n.Z_b=function(a){var b=this,c=a.Rca;a=a.s3;var d=OIf(this.D).sourceCode();TIf(this,iC(this.J,"Saving new macro",av(),!0,0,!1,void 0,!0,["waffle-recording-toast-saving"]),!0);this.H=!0;nC(this,SIf(this));cp(Hj(Ij(Fj(dp(Ej(Ej(Qo(this.ea.jf("/saverecordedscript"),["script",d]),"name",c),"shortcut",""!=a?"Ctrl+Alt+Shift+"+a:""),"POST"),1),function(a){var c=W0d(a,"scriptId"),d=W0d(a,"filename");a=Number(XK(a,"lineNumber"));c=new QIf(c,d,a,b.Ra);jC(b.J,c);TIf(b,c);b.H=!1;UIf(b)}),function(){TIf(b,iC(b.J,
"Failed to save macro",av(),!1,1E4,!0,void 0,!0,["waffle-recording-toast-save-failed"]));b.H=!1;if(b.D){var a=b.D;ritz_api.RitzModelApi.setScriptRecorder(a.C);a.H.setVisible(!0)}nC(b,SIf(b))}).setTimeout(18E4)).$e()};function UIf(a){E(a.D);a.D=null;nC(a,SIf(a))}n.U3a=function(){UIf(this);setTimeout(function(){return PK("Script recording canceled")})};function SIf(a){var b={},c=!!a.D;a=a.H;b["docs-script-recording"]=c&&!a;b["not-docs-script-recording"]=!c&&!a;return b}n.b2b=function(){BDf(this.O,this.V)};
n.j2b=function(){CDf(this.O,this.V)};function TIf(a,b,c){a.C&&(kC(a.J,a.C),a.C.setVisible(!1),E(a.C));a.C=b;a.C.render();c&&(new vZ(!0,av())).render(gv("docs-ui-toast-content",b.getElement()));a.C.setVisible(!0)}n.Ma=function(){E(this.D);this.D=null;this.C&&(E(this.C),this.C=null);lC.prototype.Ma.call(this)};function VIf(a,b,c,d){1==a&&SJb(od(c||""),od(b),na(d)?d:-1,!0)};function WIf(a,b,c,d,e,f,h,k,l,q,t,u,w,z,J,S,ca,ba){D.call(this);this.L=a;this.V=b;this.oa=c;this.Ba=d;this.J=e;this.Ra=f;this.La=h;this.D=k;this.C=l;this.Ka=q;this.H=t;this.O=u;this.Sa=w;this.Na=new en(this);this.Aa(this.Na);this.Oa=new yj;this.ea=new GDf(this.oa,this.C);this.Wa=new RIf(this.oa,this.J,this.V,this.L,this.D.D,J,this.C,this.ea,S,this.C.J,ca);this.Aa(this.Wa);this.Va=new BIf(J.H,this.D.Ea.C,l,this.ea,z,this.D.Ea.Ba,ba);this.Aa(this.Va);this.F=null}y(WIf,D);
WIf.prototype.init=function(){var a=this.D.Ea.Ba;a.Vh(lgb);a.Vh(aF);a.Vh((Xu(),ru));a.Vh(bF);a.Vh(cF);a.Vh(igb);a.Vh(jgb);a=this.C.Gb.D;var b=this.C.Gb.C;b&&(b+=a?"_"+a:"");a=A();a=B(a,"docs-tintd")&&B(a,"docs-thtea");this.F=new iEf(this.Ba,this.V.C);this.Aa(this.F);var c=this.L,d=Zo(this.H),e=xCa(this.H),f=this.J,h=this.Ra,k=this.La,l=x(this.O.O,this.O),q=x(this.F.D,this.F),t=(BA(),zA),u=this.Ka,w=this.Sa,z=this.Ba,J=WC(QC.getInstance()),S=this.D.Ea.C;var ca=A();ca=new DGf(tc(ca,"maestro_container_token"),
tc(ca,"maestro_domain"),tc(ca,"maestro_script_editor_uri"),tc(ca,"maestro_new_project_uri"),B(ca,"docs-emae"),tc(ca,"mae-pai"),B(ca,"mae-cwssw"),B(ca,"mae-aoeba"),B(ca,"mae-esme"),tc(ca,"mae-dret"),tc(ca,"mae-ses"),B(ca,"docs-tdd"),B(ca,"mae-seitd"));d=new FFf(c.F,String(z),d,void 0);z=new OGf;z.bind(e);e=ca.C?2:ca.D?0:1;var ba=new Tz(void 0,void 0,!0,sC.getInstance());k=k?new fHf(k,ba,e,S,void 0):null;c=new vIf(c,ca,d,z,f,h,k,l,q,t,u,w,J,VIf,Nvc,b,a);c.Aa(d);c.Aa(z);c.start();pu.Qa(wIf(t));qu.Qa(xIf(t,
a||!1));uQa.Qa(!0);vQa.Qa(!0);iu.Qa(!ca.Ea||ca.F);ju.Qa(!0);pQa.Qa(!0);qQa.Qa(!0);rQa.Qa(!0);sQa.Qa(!0);hu.Qa(!0);oQa.Qa(!0);wQa.Qa(!0);xQa.Qa(!0);yQa.Qa(!0);zQa.Qa(!0);AQa.Qa(!0);BQa.Qa(!0);CQa.Qa(!0);DQa.Qa(!0);EQa.Qa(!0);FQa.Qa(!0);this.Na.R(NK,"runMacro",x(this.Ea,this))};
WIf.prototype.Ea=function(a){var b=a.Io;a=Bc(ritz_api.RitzModelApi.getCustomFunctions(),function(a){return this.Oa.ad(ah.Ca(),a)},this);a=Hc(a,function(a){return a.getFunctionName()==b});null!=a&&a.qs()?(Xu(),ju).Ub(new rEf(a.lk()||"",b,void 0,void 0,void 0,a.Tr())):OK("Script function "+(b+" could not be found"))};function XIf(a){var b=a.Rta;a='<div class="waffle-record-script-dialog-name-section"><div class="waffle-record-script-dialog-label"><label for="waffle-record-script-name-input" id="waffle-record-script-name-input-label">Name</label></div><div class="waffle-record-script-name"><input class="waffle-record-script-name-input jfk-textinput" id="waffle-record-script-name-input" maxlength="50" aria-labelledby="waffle-record-script-dialog-description-id waffle-record-script-name-input-label"/></div></div><div class="waffle-record-script-dialog-label"><label for="waffle-record-script-shortcut-input">Shortcut (optional)'+
('</label></div><div class="waffle-record-script-shortcut"><label for="waffle-record-script-shortcut-input" id="waffle-record-script-shortcut-input-label">'+U(b)+'</label><input class="waffle-record-script-shortcut-input jfk-textinput" id="waffle-record-script-shortcut-input" maxlength="1" aria-labelledby="waffle-record-script-shorcut-description-id"/><div id="waffle-record-script-shorcut-description-id" style="display:none;">');b="Optional numeric shortcut key, use with "+(U(b)+" to run macro.");
return V(a+b+"</div></div>")};function YIf(a,b){OB.call(this,void 0,void 0,b);this.Rr=!1;pA(this,!1);this.O=new yj;this.F=new rB;this.Ha(this.F);this.J=new SU(this.qa());this.Ha(this.J);this.L=new rB("Number");this.Ha(this.L);this.C=new SU(this.qa());this.Ha(this.C);qA(this,sA(sA(new nA,{key:"discard",caption:"Discard"},!1),x0a,!0))}v(YIf,OB);n=YIf.prototype;
n.Da=function(){OB.prototype.Da.call(this);B(A(),"docs-egmd")?(T(kA(this),"waffle-record-script-dialog-gm"),xA(this,"save")):T(kA(this),"waffle-record-script-dialog");this.setTitle("Save new macro");this.Nb().appendChild(oz(XIf,{Rta:C.Qn.Aq?"\u2318 + Option + Shift +":"Ctrl + Alt + Shift +"}))};
n.Ia=function(){OB.prototype.Ia.call(this);this.F.Xa(this.Ja("waffle-record-script-name-input"));B(A(),"docs-egmd")||T(this.Ja("waffle-record-script-name"),tZ.getInstance().dc());this.F.setValue("Untitled Macro");var a=this.F.Pa();this.J.setPosition(3,2);this.J.render();this.J.bk(a);VU(this.J,a);UU(this.J);this.L.Xa(this.Ja("waffle-record-script-shortcut-input"));B(A(),"docs-egmd")||T(this.Ja("waffle-record-script-shortcut"),tZ.getInstance().dc());var b=this.L.Pa();this.C.setPosition(3,2);this.C.render();
this.C.bk(b);VU(this.C,b);UU(this.C);this.getHandler().R(this,"dialogselect",this.bQb).R(a,["focus","blur","change"],this.Pvb).R(b,["focus","blur","change"],this.XBb)};n.focus=function(){OB.prototype.focus.call(this);uB(this.F)};n.Pvb=function(){""!=this.F.getValue()&&UU(this.J)};n.XBb=function(){ZIf(this)&&UU(this.C)};
n.bQb=function(a){var b=this,c=Yx(new Xx,12).build();if("discard"==a.key)aF.Ub(void 0,c);else if("save"==a.key)if(""!=this.F.getValue()||TU(this.J,"Must not be empty.",!0),ZIf(this)||setTimeout(function(){TU(b.C,"Must be a number from 0 to 9 or blank.",!0)}),$If(this)&&setTimeout(function(){TU(b.C,"Conflicts with another shortcut.",!0)}),""!=this.F.getValue()&&ZIf(this)&&!$If(this)){a=this.F.getValue();var d=this.L.getValue();ogb.Ub(new EIf(a,d),c)}else a.preventDefault()};
function ZIf(a){a=a.L.getValue();return""==a||/^\d$/.test(a)}function $If(a){var b="Ctrl+Alt+Shift+"+a.L.getValue();return ritz_api.RitzModelApi.getCustomFunctions().map(function(b){return a.O.ad(ah.Ca(),b)}).some(function(a){return Ke(a,9)&&G(a,9)==b})};function aJf(a){FK.apply(this,arguments)}v(aJf,FK);aJf.prototype.F=function(){return WIf};aJf.prototype.H=function(){return YIf};aJf.prototype.C=function(a,b,c){return new MDf(a,b,c,void 0)};aJf.prototype.D=function(a,b,c){return new bEf(a,b,c,void 0)};LK("ritzmaestro",aJf);
